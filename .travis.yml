language: cpp

os: linux
dist: trusty
sudo: required

addons:
  apt:
    packages:
      - libboost-dev
      - checkinstall

matrix:
  include:
    - env: "_options=\"--enable-debug-logs\""
    - env: "_options=\"\""

install:
  - "mkdir -p m4"
  - "autoreconf -ifv"
  - "./configure CPPFLAGS=\"-D_GLIBCXX_DEBUG -D_GLIBCXX_DEBUG_PEDANTIC\" CXXFLAGS=\"-O1\" ${_options}"
  - "make -j$(nproc)"

script:
  - "./bin/asteria </dev/null"
  - "CPPFLAGS=\"-D_GLIBCXX_DEBUG -D_GLIBCXX_DEBUG_PEDANTIC\" ./run_tests.sh"

notifications:
  irc:
    channels:
      - "ircs://chat.freenode.net:6697/#mcfproj"
    template:
      - "[ lh_mouse %{repository_slug}#%{commit}] %{result} on %{branch} by %{author} (%{build_url})"
  email: false
