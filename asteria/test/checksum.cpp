// This file is part of Asteria.
// Copyleft 2018 - 2022, LH_Mouse. All wrongs reserved.

#include "utils.hpp"
#include "../src/simple_script.hpp"

using namespace ::asteria;

int main()
  {
    Simple_Script code;
    code.reload_string(
      sref(__FILE__), __LINE__, sref(R"__(
///////////////////////////////////////////////////////////////////////////////

        const s = "abcdefg";
        var h, q;

        // CRC-32
        const crc32_results = [
          0x00000000, 0x312A6AA6, 0x7FD808AF, 0xE643CF1E, 0x0A321D29, 0x601B0C2E, 0xF57CB98C, 0xCEC343C6,
          0x2F0CB3EB, 0x9172ABF9, 0x35F9C1EF, 0x9CA74BF6, 0x668A8270, 0x6B210FB2, 0x6710F04C, 0x6102348A,
          0x7BFD59A7, 0x943D6D08, 0xDD3C3281, 0xE6161985, 0xD3698066, 0x673F04EA, 0x88EB3104, 0x7DAAF2A7,
          0x48BEC022, 0x89B79A00, 0xBF617236, 0x5D305635, 0x89E06440, 0x5EC16CFD, 0xB4124764, 0xD4BE25AB,
          0x2526E10C, 0xF2FF4D5D, 0x26E5E2C3, 0xF23EED74, 0xB1A94E09, 0x49199071, 0xEDBF453E, 0x20612956,
          0x55EC1316, 0xA1916629, 0xAC138A6E, 0x7575214F, 0x224A86B4, 0x3581D18D, 0x4AFABFAF, 0x9D789824,
          0x7D657170, 0xD5BBE495, 0x77921A07, 0x0BEE9980, 0xC3B03960, 0xEDD639DA, 0x3F4C73D4, 0xD65B6F20,
          0x4BC9F62A, 0x313CA3E6, 0xE2945088, 0xDEADCEA7, 0xD6F86D0F, 0x0873FB12, 0xC5F8BC6B, 0xEC44A41F,
          0x13EBD570, 0x821939AE, 0x2F6B1FB3, 0xC48476E1, 0xF4CF46DA, 0x85D92126, 0x0FD5EBB2, 0xE3353F11,
          0xA8A49184, 0x9631691D, 0x1CB2E674, 0x99D8D552, 0xBE5E8512, 0xF5982A29, 0x9DF6BAFD, 0x078C9D28,
          0x85417DEA, 0x9E52BA10, 0xF2E9CC47, 0xDF07841C, 0xD862BF0D, 0xBB731F9D, 0x39B49E90, 0x91EA7256,
          0x505D435E, 0xC0828456, 0x4965ED11, 0xED971A0A, 0x702476F0, 0xD75197FB, 0xE9C04525, 0xB158012B,
          0x9A617990, 0x84601FAE, 0x2F3724FA, 0x864993EF, 0xC2E10B6A, 0xBDDB412C, 0xEC0E3888, 0x41630B12,
          0x56962547, 0x57C7371A, 0xE6149DE3, 0xC4EEFC17, 0x9FC8116B, 0x4C57F16F, 0xC9EB6848, 0xF6288BCD,
          0xBA2B5D48, 0x3200FA7A, 0x9719EF96, 0x1747AC19, 0x8AAF8951, 0xFDA493AD, 0x7D0F4BC9, 0x1635A5C1,
          0x0E224171, 0xE4EF63A7, 0xCEDF7CD3, 0x4AD6CF79, 0x5A78619F, 0x8610F444, 0xA7BF1EA6, 0x6EA65160,
        ];
        h = std.checksum.CRC32();
        for(each k, v -> crc32_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.crc32(s * k) == v;
        }
        h = std.checksum.CRC32();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == 0x8731D904;
        q.update("2");
        assert q.finish() == 0x1E3888BE;

        assert std.checksum.crc32_file((__file>>3)+"txt") == 3626666760;
        assert catch( std.checksum.crc32_file("nonexistent") ) != null;

        // FNV1a-32
        const fnv1a32_results = [
          0x811C9DC5, 0x2A9EB737, 0x7EA29A85, 0x1831BDF7, 0x52A4B745, 0xFBB9B7B7, 0x62CA1805, 0xA783CA77,
          0x7B14F8C5, 0xB8D3F037, 0xFA4D7D85, 0x21524EF7, 0x1EAEE245, 0xF825E0B7, 0x5C924B05, 0x7021CB77,
          0x4B5BF3C5, 0xC7A00937, 0x22660085, 0xBF6EBFF7, 0xE22DAD45, 0x9D6AE9B7, 0x337E1E05, 0xF82DAC77,
          0xA8DD8EC5, 0x80670237, 0x7BF82385, 0xB54B10F7, 0x034D1845, 0xE8ACD2B7, 0x09D99105, 0x302B6D77,
          0xD505C9C5, 0xD80CDB37, 0x128FE685, 0xA52B41F7, 0x0AB92345, 0xAA8F9BB7, 0x6070A405, 0xB01F0E77,
          0x4BC0A4C5, 0x1EF59437, 0xA8394985, 0x20D352F7, 0x539DCE45, 0x173744B7, 0x468F5705, 0xC78C8F77,
          0x737A1FC5, 0x91052D37, 0xE5804C85, 0xB98743F7, 0xBBA71945, 0x5647CDB7, 0x8A01AA05, 0x8D77F077,
          0x4D1E3AC5, 0xE59FA637, 0x8970EF85, 0x100B14F7, 0x53010445, 0x12E536B7, 0xE7139D05, 0xF0653177,
          0x2418F5C5, 0xDFA8FF37, 0x99973285, 0xE4A2C5F7, 0x0C578F45, 0x0BB37FB7, 0x38913005, 0xC6585277,
          0x3E5650C5, 0xDD853837, 0x91FF1585, 0x271256F7, 0x6CD6BA45, 0xA2D6A8B7, 0xA7C66305, 0xDCD55377,
          0x8C424BC5, 0x69185137, 0x95349885, 0x069DC7F7, 0x3C2A8545, 0x6DF2B1B7, 0xDC7F3605, 0x08E03477,
          0x58C8E6C5, 0xC7C64A37, 0x9C43BB85, 0x020918F7, 0x347EF045, 0xC62B9AB7, 0x2D07A905, 0x36FCF577,
          0xF95621C5, 0x8A732337, 0xA6B87E85, 0xF79849F7, 0xB27FFB45, 0x582563B7, 0xCE2BBC05, 0x7B2F9677,
          0x7DD5FCC5, 0x1D82DC37, 0xEA9EE185, 0x350F5AF7, 0x6559A645, 0xB4040CB7, 0x03376F05, 0x20FC1777,
          0x60B477C5, 0x58D97537, 0x0482E485, 0x87B24BF7, 0xFEB7F145, 0xDD6B95B7, 0x4DF6C205, 0xBB667877,
          0x36DD92C5, 0x0FDAEE37, 0x27708785, 0x4C451CF7, 0xE2C6DC45, 0xDB7FFEB7, 0x9EB5B505, 0x34F2B977,
        ];
        h = std.checksum.FNV1a32();
        for(each k, v -> fnv1a32_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.fnv1a32(s * k) == v;
        }
        h = std.checksum.FNV1a32();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == 0xF193366E;
        q.update("2");
        assert q.finish() == 0xF09334DB;

        assert std.checksum.fnv1a32_file((__file>>3)+"txt") == 3790343712;
        assert catch( std.checksum.fnv1a32_file("nonexistent") ) != null;

        // MD5
        const md5_results = [
          "D41D8CD98F00B204E9800998ECF8427E", "7AC66C0F148DE9519B8BD264312C4D64", "B7B68FCE5078A4C8EEC0362E78AB9E18", "24D1FB65E396E77C6A95889B02EDCDEA",
          "95CA519E244290C647712C781060980F", "68BCCF1894D70B00D1CC8C9AFA9006D2", "DDEA00049329198EDCA6AE3113B06169", "06D33DEEECCFC210B42DF1260D0E1F41",
          "34193810151967289007E1A8A41CF7D9", "08B839B0917E4C4E40979AD470033E22", "01BEC5F107817E3B66C25CF215BAF72F", "1D2F26342F9F5A2524DBAE079238DC52",
          "FEEBE5881FA2F3B2E55C9A3F1B3FC547", "B74038C10EAE24E415324208D580341F", "A182D1F3DBBB2EEF2C9CA0557FEB702D", "CF9125057FA59BA5BCB6ED313BBA97F4",
          "939BA051CAFE7278F16FA26D5181454F", "1319CE4ABAEEB156D4C89F606C4323A4", "60E2AFE19AA07E4273C55386262EBE31", "A29ECA25AF22203B6AFB40A30B2CF1AB",
          "4BA3B190ADC6B0BCE2E0D9B1F451534D", "22BCDEEBA92A0FF7155DB6455F6702A0", "1219C498354B3E18D38373E580A064BC", "75C88CC2F1233516CB41CD885A473D7F",
          "22876FD8FD4502F7A54CB933D170D76F", "0876D8D0121E4554C93A30C18FBBC7D7", "8D38716E9EDD604628059EAC77D704EF", "0425B432E7C7FBFFCF23F0D3CEFE072A",
          "956840825DC2CAED7815B9F90C042BC9", "BDCAB46D0EAFB59DA35A3692A57023B9", "1DBC0A399323C629D4036EE5E5ED2079", "076387CBF6C90969A4D8055669EFBF74",
          "B8A869DB5A43FD48C6B49B843B855EE7", "A2808B3C8D7BF9891D4FBC825BA356A8", "41B72604E1A00FC0F261983596BCD341", "C48DA296AB979BA5242E9929E90625E7",
          "AFA8CA6381C644A686DBE7FCF6057D60", "23B7F2A2BE894FF35760A0AFFB47B322", "CE3171B16A391374F4D5CCAA8D5C4519", "02A1C3F3C7BC1A1E8A8623113759F3B5",
          "0C8988C2D46231A09CBE5907981EA6E0", "7300E2BE0454DF4E19D49E1EB4181F45", "86E97D2F9A6AFDD3EEAF7DB6E61EDA32", "28277EA78C184091C1CAFEEB745E8DE8",
          "18E9B46F9586FBA8FEE641BF8BECBF17", "EA3397962BF8CCE4329E78C49C43DBED", "B1AFB50796ABE7189AD87FB14683C3AD", "C6FF0A9D5B635C305CF89526449CDAAE",
          "04B07B3E42D73A830A0F5B651F894C56", "126146FCD8CC23574B66508EB30858E4", "369E6FBDE2304111C1A4D28EF00658FD", "953431548C4069F1A1D3420469448252",
          "482BB820FD904300E6FD90963873DB50", "538CAB982B3151470BF47158E986DFFB", "94247FBA1525017AC6DEFF922A971BFB", "E3DCF7465533ED9DD772F304CB68A343",
          "90196C6C2955356859A7A9E7A890F20F", "67C92F044A18D900120180D5EFECC97C", "B00D309D890BEFA9DB08056A86C59D11", "8A29CC97B19238C5A91AA311434D5EA5",
          "F8896245D4167019C0D68C67CC6A0C83", "BA1B303E7ACF0D374908FCD1BA77D42C", "05E0B6D77C1CAC6E2A77E7A6CCEF986F", "082AC63B636E0DECB9D2040CBC22E1DC",
          "E92D20F7DD4B31FE01069510B40C0AF9", "EDF8E99ABCF7AD1921F18A8FC720277C", "879BA77B1810B537126C35095D6B25D3", "EA558E99FBA6EBF976B50509E2EAC5E2",
          "BF94961FB6AB1DF88B1A7EBE79921DC7", "58EBEBEF031F708829E4A23776A6E4A2", "86DD4C7876F51662CC047423DB445615", "820FEB1E73E0DD5FCBD8D5454529416C",
          "1512B3E8AA41F80FF0736FA4BC4C7C13", "7F65711DBD69752768F72A86CEFC6374", "155481B209E4661C883C3D2A99FEBB3A", "7952B7C98C6CBB451D9D06392D2C4EEC",
          "1633CBA5D9DC7251B0D1FDDAD5818646", "1C20BFBFF4822E4D426B00F0815100E7", "861F76986529C7DAE775D10C252CFA75", "D76A6A3A01117E9A0C2479E4D14902C0",
          "AAE276021802E064AE9F02791A00D647", "946EC6891FD451CDDE92FFFEB05E9B6E", "65CF1198DF4BA541814F958A0A27FAC6", "94B7A2817B3AF64BE74B9884C0CD81AF",
          "BBA094483232A5359E085F4E565E2014", "8552DA0EABCFC17447E8A24A72B4BB83", "CD486256574D514FA4292D43F5F10FA3", "567A8D2E4D03F46A7B1A5DA4BA90C28F",
          "577B66E00A937304A0954A26899C6F5C", "C3C6290F7E8E9782515B73D96E7E0E77", "B9608161277649A510AF3EE09A8DD3F0", "5438DBD340E1F9933F66AEA78817B51D",
          "B36B00F9C030627478BF88B8A094D221", "D9DE65F433BBA6B05EDC6E153F2C93CD", "F1CD21709245D40B79D07038140E85D5", "B47B7EAC82D208B433C3A20CC146A92F",
          "A2550BCD15C5D75086EBE49CF00E76A6", "38BDE99755CB939636738C6EB288C968", "8D927DD9233373889F4D550AE3AF1DD8", "07A2274DAD6E0C1D7775FA7562E8736F",
          "13D999FE3624A381EB8E3B9BA9A15811", "2126346CC4B8E8E8C68D9A98188F6678", "A3E41776EE8B5FD3B48699668C23C275", "5D25C1387B32690B0AC40E9321D1D22D",
          "52157E2422A8E8F2A0BAD2CFE2988AF7", "A94B1AC971879DC41467D3D6689011FE", "8D9F613C93E0B2178AE92C50CF284995", "57795BCF9E5B413D026A5D0DDAB165D1",
          "60E2F2414A6F077BAF22D441B676E23C", "7C82C6366FE41021FBF9FDECBB063D12", "A891E066EE85C9669084A8923F35A5B3", "C81F33FB748B069B645A760B8791D0DE",
          "DA43E225C1137DB1C4B234D5807BDDAF", "D39E3F40205644B0B0F69F3AA822E7B3", "345845937DC2427CBD8D747D23991C33", "FE25465B3A6CF53DF6AE4CE639D3C65B",
          "B621A8719AD46B056B03A00409F3B011", "64D73A64A1823810090029C445020C95", "63C0FAD58AF870D87FE6BB61E61F1ED2", "6061D93284C1516A6C99E667ED00755B",
          "8CD81F0F4536C18477DED17610840EE5", "F0F7CC1FEC0DC900B81676B432BF3BBF", "9F30C26BE78BBFBB3BF777A89F9BB4F8", "65C1BA86506E577A847AD6FC585DC01B",
          "8341C2174A953D048FEF4A92A38041C3", "B168C6C4896F029B2C7C5990C94E7AC8", "99AF26FBD01C1F26AF0D2C80855D4273", "60F727F61ACF60E7314C16E0ED9805AE",
        ];
        h = std.checksum.MD5();
        for(each k, v -> md5_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.md5(s * k) == v;
        }
        h = std.checksum.MD5();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "203AD5FFA1D7C650AD681FDFF3965CD2";
        q.update("2");
        assert q.finish() == "6E809CBDA0732AC4845916A59016F954";

        assert std.checksum.md5_file((__file>>3)+"txt") == "67C62663B722611BA87041EB05870EB9";
        assert catch( std.checksum.md5_file("nonexistent") ) != null;

        // SHA-1
        const sha1_results = [
          "DA39A3EE5E6B4B0D3255BFEF95601890AFD80709", "2FB5E13419FC89246865E7A324F476EC624E8740", "9BBC2BB3533171D8E501F28D8BC075051DAF6D60",
          "666DF4C2B88316FC3580B6131EFB2519FD839F5A", "12EC1179A61868E15D307D9487018947724F3030", "88C70F7B77F2DEE9F3878B11205196074D7F063E",
          "3F84309612F276D8B9005EA969A56D8FB585A09C", "455ACAF77FDF07461E3412481416CCD3DD2772E0", "15F1B9863855123BB3F7D26739E5B140774ABC26",
          "F210A1C82323C7783B639BB63E42B1D57D5DEAE4", "17326AC495033B6D24F75AFF0DDB90C5F2FA22FE", "175B3B8424FAB42F9E42E1D23970692FB182E7AA",
          "209FEA0B5BC787CA3C5FE4BEE2E43A7A659F52C1", "8A37BEB17AE39A67433D826A4A35C91532D8C695", "AC4F90A5C535D171F3BC45FD5CD8D9DA7C70D7FA",
          "277104DD7FF67D71B3B938AE44083E560293CC48", "F0E138B258BC49C9460EE6234FC521FAD4B0FC7E", "057124F61B03702D1536F61992C658B8CD52820F",
          "EF24DCFBCFAF276B43E8028B3B99DD95277157AE", "960BE836586A16F17A67212C0018534FE1D97147", "613435029C90462BEED9FFC40FDD08CF1146895E",
          "CEF97E7DB40FFD5C6FFCD62B4CFB82301D100291", "513AEBEF107CE2CB071E989C73F7D3017F9DC03A", "E7CC18EAB37538F0D6A546FA86FA7010A61A1AD1",
          "CE5A222F5BD7DDCECBB738857E6951D15978FC00", "295047C57492895C6B682A617F2012A4FA84BAAE", "35BE880243ED8E2489BD252774E887F47963ED60",
          "F64C4595DD2C86E59D50779854E0A61168B52442", "94E7F3CAF7C8DA5326837D693AC3F82AB1E40CBA", "25FCEABCB718D7FE54729CF5BD2A1255E5C541ED",
          "C1E7943D42F9D8D988EE7EC6EDF79EE1F35AD2FA", "3862C0C71BABE9599E96EF8426007597605B9329", "123679E35CA60EC361E454E53A00458EF269348A",
          "E6D7D44EF3CFC912B92DE50AFA71819B3395A44A", "3EA3F92C5D46A251609820D92BAE0AD883A0BB01", "BD3ADB6E817ACF6429D5D5329192C04F82A949D6",
          "A478C13CC918E173AB8007D7D23D6658D8F27054", "3514CFE30FB1CD41D5D5A70DB38970B6715F20B4", "8DDA62B92DFF7B0754BA340DBD87F906B8979A7C",
          "10EBCD0091E0EA0CF5D122418DE4957C47077DB0", "EEDC83DA2CCD7273353B91F85FDCEC42871F4798", "865F91DD1CC2CFC6E8D086C4A8B9F41C43173636",
          "04D2625191F6EA8402EDB4F1EC80713DD0BFD13C", "5349062A821F3250BC6161846C189C1BFC9E88BC", "BC09461492B7F31DDFEB4EE6E8BCCCA95480C280",
          "5C6AD6049FCCA0CAB4C1BD4870396B10ACC9193E", "B9425D27355017EE2743C725B948D8CC0E01ECFF", "82CD91878488A958488066791797D0E58C70F733",
          "81A136423B76735A00C1AC46D1A26F5F26A59D81", "5677B6FE3C4BF5E788D5BBAEDD62ACA002684CF7", "117730BC6D68C4D1AC1511CADF1C362E7202CFDF",
          "7D2A7DA5CFFA00FC11C0203ABA8597E95BE7EA8E", "6B607DB3C2F9A5052523D09D961B77AF37608674", "CA5553CF0370DBCFC1C64E45EEE463DA3BE2713D",
          "17F3D274211973B5D86047F490E3CD46D7E6766A", "D426E6CAE38F71BE0BAF5A59EBC7DC88DE37F516", "126A0B5F20F9C86D07F717E25B5C4D1663452E35",
          "C409F58CA48CF52A78BF2B28E027B6F3C697B9BC", "40E6B21D8A301BB35C1673D2698A625D2DC6ACF6", "677AD880118F490E072825211ACD66EC035F06C0",
          "A3BE7C3091A687AC1BF8F49582FF1B09B7E54DD6", "4F44298543C013E8CAE33B39F5EF59A5A921960A", "E59C691E55331AAD61DBAB99816C22A35BE1C07B",
          "AC51952B98A011FB3186AEBF09CC9394BCEB3326", "106BD904C28D5D1E222D5C9DB45A281313194ED3", "FF62610CFDA5BFDDCF9A8BE1007C8DC813FC07A1",
          "D47201383086A617FD13C18FFA243399D2D81068", "A555B5CF32C951F40A7ABDB52C1071D4A2F9FC61", "708492E7F6129DC474C032C7161316B7C78F5E52",
          "463B73616B3A4AE1DFCF8D1E540B383813C92E6B", "CDBD4D2E93A542D507ED4C186F0B7552375D8B21", "47E091CBEDC401FFC47B573B64BDF272F4D5FDB3",
          "AD57CF58AA0EAC0D7784D2BF373DACA62E24381D", "A20EC52098A20B34EA5854AD61377BA5AE409EA1", "A1AC6B4E8C6DC3474756705D2ED7B416138D61E5",
          "EC8F16B7AE3DC6A8FC35E38B3D22AF1E3AA37CD3", "3996734E86F987C4279E3B08FE8FF406836FFE8A", "9840310718770574C55F8728DBAD6004DD61E82D",
          "2E404B3C74A8E7D1A19011C7D9326171960C983D", "FAE2FD285EDB3C5C7F1AC2F6BF6C85DECF946EB3", "EC27F0308AC0B713044A28A0A0C60F584BAEFB44",
          "52D0AF39F2E24BCC4CE481DB5761135A7CD37D0B", "6555051B96164B616E59FEB2C1B0AC110473BBDB", "1A6383B4A621844BA3C1495C814B506C729762A5",
          "55CA912D322310D27CF340534CBFAC9E3ECE77E9", "53C31F48F83DE8F65B9C8E465D95B1C23C1AD4F4", "0ECF72BDDB5AB58364BB88D353F7FA0C5D631324",
          "F0782507E5CB935EE4899D25E3A5E281F74FD65D", "D0BE894838A1EA700AAD99F18F3DB84AE01833F5", "DD2940C36F0C7798D5EFD8DDD4ABE46C9FAA874B",
          "C0A613A5A9CC8D7A693E078DA2A967800DFABB5F", "B469D611D3403A9E12B18C62167A67AC088CB588", "36B749BE6E38211AF3A2EB832639EA62ECC405C3",
          "08E122730946DD3A7EC552792180C222E14FE54A", "F7A592DF06F136A44A87FF5FFFA71719C3E7F90B", "DE953ABDF424B10188B0115C5D654AC86D90EC9C",
          "7E0FD84A04A640AAF441BABF4D115A2605C5FFA1", "30BFD07640052084EA9AAE9DD69F22A8488D0736", "170E187CB6B0DF88DF6284DA6B15B0D4BAD42F09",
          "977AABFCFDB977F7F2A51D29F9B956F99C3C885E", "BFD4876C1E3D5B9976A11BCE9A246C4B69CC4618", "4B561180D1BA60F05A631F96F714325A1FEDB347",
          "122D1EAC5F7A126762A8B51D182011AEDFC32CF3", "9FD03B59A41313FC8E2800AD5AAA299749FD008B", "7148F202DDA9960688FF8362E22E78ED9379A6AB",
          "FB95B409D10FDCE3A4AD16E35EC111FBD3EC753E", "DC4144B9DC2662231ED7F89EF9D779D03287D458", "9A329E67AD3975AD28E9B374F9D0F699D3A06C5C",
          "DBCBC8461BA93C4C09A742DC1ACAE1BD1BE80099", "A4366A7AB5838C8A55B88DFBD0DA85D71C8DACAD", "51005855312E5585294D2BF43E4F14F7DAA17448",
          "D347F7CD04198ADC63293CC2AC9C7D08DC686A2C", "532DD2328A305F0C809B11B666ED02C5DB2C48DF", "BD3FA95D48F6A0862264431BDE46092ED826135A",
          "90DFFC3F1BCFB76DF502B739AABB8C72B0CF009F", "9E6DC9FAE92EF51E85071A0B3336EA4494740283", "603D7D0D4AB926BE6E7699E09D5BF9BCDBBB394D",
          "51C1ABD5DFD13EA7D671B8EFE0B318D23AA16D74", "299F577E14B90351DB885D1F16935C2B92D8136B", "3ADD065C558B7B9BC04D73673429436602D4A17F",
          "22614330B65EDE754F652BCEE0FE59E387E960EF", "8B380F11F875B18EB1BD0B39A8D60F752B2E57A3", "1E0EBE55E292F7F20F1DB6426D88A2EA3DCB2D5C",
          "12740FBAB42264E61B17F3C234ACF1AE9DFAD7BE", "C2D328C68C0863EA596B4C46361C8A1321A98D0E", "53DBD67B08BAABD0FAADFD505CB54B09A9D8A3CA",
          "338748A8A6C46B4A9B25CA09775F4137374F17AB", "3D22D695ED0EC9CF888A9D25644EE95A830FB94D",
        ];
        h = std.checksum.SHA1();
        for(each k, v -> sha1_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.sha1(s * k) == v;
        }
        h = std.checksum.SHA1();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "88FDD585121A4CCB3D1540527AEE53A77C77ABB8";
        q.update("2");
        assert q.finish() == "0F1DEFD5135596709273B3A1A07E466EA2BF4FFF";

        assert std.checksum.sha1_file((__file>>3)+"txt") == "6BD103FB2F8F84E6A7B36D27E1FD6243B6320BE8";
        assert catch( std.checksum.sha1_file("nonexistent") ) != null;

        // SHA-224
        const sha224_results = [
          "D14A028C2A3A2BC9476102BB288234C415A2B01F828EA62AC5B3E42F", "D1884E711701AD81ABE0C77A3B0EA12E19BA9AF64077286C72FC602D",
          "7887B901A3AC2BBE74A61CDA53AA7630DCABBF368DA0EE3FBCCD40BE", "78DAA8D6DE2E2FAA3FF16B6563AB440F9DB6CC08CC9226709F6523AE",
          "197042F302A42C07AC0E2A854B3D500CDC19C34315286C8E23741E37", "5811F802BE0245AB4B9DC7DBBA229FF0430ABA975124CCD9CDE1A90F",
          "C649F2719EE9A306619FFA6B6EBEF804CFD02139F71B30782439F82E", "58671D114A89E2231DD2523ACF4C14F792DF4FCD5C5CD209C17FE9F1",
          "F9172C6BD5B40ADC6C4B875EDE079B72465DCCFB7AD112D99B4CA68E", "95986D4290B0744F9D39BB51F45D5E9974068E2332A92B90B066194C",
          "FB744F1514D0ECFD53B771E30F48C8CAD6459A51A7DB2BD6952A4CEE", "0E550BC4F4F3F54E3AA372C3A27138BC3BB82416632128E8EC7326B7",
          "4330CED069B35123517A8000B3AA5AF9C86EDDE74032758B148854F1", "9AD98464BE3FC71112DD4EE08FE225A5AC930DBD72C7AD96964E978D",
          "715C79687BC38FEBE41DAABAABE3569C1863667AD6B77F09CB2D74E9", "E39A60D4DFB08C7C3D307F6A33B93219F860FD4708B4BE93F0B65160",
          "E7CD80B2F9DF26B35F3BF19937135A9AF155B166CFEC5441F47BB0C3", "EC54784D19A04A98723E95D128D5252DA6B41E24B474483B6DF8172A",
          "7488BD8DC8C24359D4D69D07BB9C2D790EE2C76E10876925F7B70DC9", "76398CF73A017CCE576AA3893639891E5C4E85C3BC8D96A903485444",
          "28E3A2079DE499A150AA53FA8FE198B7C0DC00FC8BFD85A4CC78FED0", "997418622EE7229FC0CD10DD352E2E92F90E98F297790D304174BF7B",
          "CF89003A2B216169B44F4BC499B06E05A49392A5C2E3531CC2952003", "BD68DAF57828DED46989D97380210B156BCC62189C93BC6B27E415E1",
          "5BA1FFE5B0D9BE2871092B4B0CBD38158C84843DD5AC14E061F105F1", "8AC2ED8D06F722C90A68170192BC6C2BC3826EBB3A919A6F4DBC0A07",
          "63AFF99F080FA07AE4E9FCAC7E33CBDAAA686E606DC3FA96E15C119D", "FE4F8F354C4F2D69C7D949910F6CD5DBE21E3B271A59B93AE6563956",
          "DB14BB7BBE0B7D34B75A0B8F696501FA2C5900EAE116FBD65418317E", "E7D161F8470DC94B60552C83CDBC1EFF627512EDA984B923F13E70CA",
          "2D06225A961E990879B5B3A785AFC13BBF82763E7031F29E98782044", "9A8FE3EBBF58A6B964E5E7A642400FB11ABA91AA8FFE0B3BE2C1E7AA",
          "51C3C031F518BAFE356E5490CF7E731D72A72E5E0801AFE5D21EFAA9", "5B954E8A7AE191C7115523CCC55F4CCAA7D8D5F908F717D3BE607E17",
          "A3A43FF883B1AA00BD7ECE0F47F98651F3354AB4ED9A4AEE9C10F46B", "6E6C350A45BDDC30B34A37C65C1F43C3CA72143477A95D4D109F3623",
          "4FC1CA6F189E0A0869B1B8A1CE892A58BACACF0B5870E2635BE27EC7", "35A69332296D53B5344AA23821BC6799580442FD9C0C1B14B05AB1EB",
          "814138860E17A2D998A981A212CC9B9D326835EBE220DD5BD05979C5", "EA8F0088D0D84B6B533869A7FE79F9726F84FEC01F6CF6C60BCDD83B",
          "09D12B7DA6B9D480EB23A60BBA47441478A306F212A8AD9BF0AEBB23", "2BFDE0BBE7BACE47ED8475D44D557DF9A5E08BCE295A45631DAFD2C8",
          "6AEF47C3A22C17E5E878898E84DF9747DA6DC1A2F84F40228E717540", "87BA6EECA4D18D15193A55D00DB39D3DD5FB9F5B0D58BC95567A2776",
          "5ACAE8E833C8E9B0F802943E7497F1C519F7CC50AD071C8627D99D3B", "9712A4B46A7B604AFBA25180DCA30C10CA32873FFBA7BF0019D622C3",
          "7413444083C31EEE48DB7C570AC6844854D83F18800A49DC250B79C5", "CF58098957884BAB8138E57CFC6A956FBE3BB65B28BE3DA5CCE648E9",
          "2392A899F70B16941A7ADF8ABC3B7DFAB83FC0A4A29814036686DA23", "C2234F93DD411B85DC3616A6DB10E159FD5B4B731BDC773EFA3F49C9",
          "50A9E1DF5A6AD7D63D7BE054860B47FF4D39691B248E1E37795ACB50", "D6D511945B3582D2BE9CFAB7B5F3EF21C397FBAA6BDA9C60A5AA050A",
          "396E858C97FE9ACF93DE45AD853BDC20D5DDEB803B33CFF2AABFA125", "5D27DF439EAE735DCC4AA6BC69459002DCBC6C58DF14EA6B4FB99232",
          "CA0EE1067B3B0587AC7FDF08DBAD29165AD32B64CB053BC2BD5BEB37", "7FA9AD8C921E6BF883633EDF5FCCA8DB1923772E06D7AEF94E5246D4",
          "0F26B86177BF7DEF04ACDB5F1DCC5FF618AFFD974C8A208AFAB8C826", "4EE871294316BF62DF48FF5DCAEE1C64740C9E134B84B86E117F6F10",
          "FB34BF27040DD148F0CCA4EBCF5F86B84D9441958C080639DE1C4476", "F8B7DC63C3FFB2B6F3874FFF44D93C1E827F7AB80C7FD39254AB6904",
          "55DC3BEA61F71E7E6AF10BE4F3E3A9F632E875619EB163491C82F4EA", "B399E58F88225FD1D17208BD2F4C844F964E15C3DC36950C7A2634A6",
          "70BBCECDA5B69647FAD50A10F00C0A811BB3AE7874EF7A524556A34B", "60077F168DB0F8F0A1DAADD5EF4C55F78F6DCB95BB8198786A0AF738",
          "D6A7CE15A4ED1FA4355AD1A6D8C3A2E382FB63B9A737F86FD3EEF68A", "B772B35FAA1D11A64EC6DE8E3662AF2BDB0E894270A091D4C935D1C7",
          "38E1CE1109B8CC655A618125A4B738D804391C0596D6ECA76D5B321B", "102C506084820238B7E59C8334BE0D2E1FD201DD5ED216269400AECD",
          "79E312837A00A7F45C5AA0D514A4B3DB18CDC2DD99265093CDA79FD7", "117C9B4E01AE7849FCD259E8073FEE09276161FB5AD093325F3DA27F",
          "8C3B793AC0E5373CFD61F62ED0237A56E1DCCD372AA327793345D8A4", "14C15D1F564D56CDB7F413D4597351EE3A1B89BAF23CAD72B942E202",
          "A2F3CF99146B1DFB6BC811202FA5E5B3916A3A65C34801B6F02F0D28", "C5CD8CCFA7151A5BDDF8F743A0ACB63A10AE952CB99C5664F41083D9",
          "2E2236EBC2EA704B7AD75E262BA9ACD50109C31DAF5F0745D095ED52", "49043B19CBCBE4D05EE31AF797DB2BBAF8BC64F42DCEA909971565BB",
          "C008C10139682C2F50CF9D3D6606455F8A850F6F299B9457BB51ED28", "D405D24EFB5D6E6C33756E14455281DBD545F74021FDDC1784295657",
          "6B4DFB36B81A0E763318C4E7AB2D5B73D1C6A4B67F3DE71B9E809D49", "1DE9B2C7C8BE7CA284A32E8FC708A75EFF40386FE6945A43AB885569",
          "5200270A510D8BE6EEEB398BE1B9D44B496F7CFB544C0D396F5937A0", "ACB6DEA2B484B3279D3E73A2AEC1012F64265FDF252A2C367ACBD6EE",
          "E379525ED4D7BB41BDA86B27FF9B81FDEC2376A57A2975E61D0DDB7B", "CE3026F120AD981EE28C98DAFA1C57A1A632D91186BC92935E8318EB",
          "8A410B8C4908315397B5A6D7ABA11B3FAB42E57864A4E7E7BA70C41D", "80B7A4CE98A1DDF4BF6E2AF60F31E9E6A200F03FCFC840A44E952C08",
          "1DC2159447DD0FCF248DA0DF5A90723C905BBEE99AB1A740440A4AC6", "C3B17F938099E91E7B4AC768C453E464257AA29CE87B5A8B30B7127C",
          "A25EBF607A489374C23CB2F45DB370CE1234CEEE3B2A07A8CFB29211", "6CD16ECBB36D349FA0EA0C012F6C6DFA3EA0E5B49C79013FAAFDA3ED",
          "E8DE21169E71ED88DD05EDA84291CD5126CB4CF2FE68F98F61F226A3", "3BC3065F0599B7AE83DB77178E1776AF157EB2DEDE9FA68086038699",
          "0C2A672E7AFBB01A494F0D31D7295EE2504C13A148446C24A8CE6DB6", "DF97B60A49FD23CABB07F7216DC5B82BA1C308FD6E8A749BA8A6CE9A",
          "9A62BE093F366CA8BE2BA80F5236CC04CCF28F7E1D1A5C4CBA63BB7E", "E745D0F2E05ADB1C7DE84FD6A2BD7B77FABA5889731E1CA5F8AE7A95",
          "AB3AE24F48CEB6634937EA3347DC4FBF0554F09D6A2FC26069E83A49", "A247EEB20B4414A739F9928FED79A5FEB29C4AF908B355605E8F12EC",
          "082D4BC79D2E61F39BF9D22970010D6EEDA5EE3D8FCE512CEA20F2BF", "5E399E3946828D77267B0F237024594382866A600F475F6E864C7726",
          "AFCD900CD3B8CF74FE34FEFE1F38A4B54DE2BFF5962CA17BC2DB8BD7", "69B341E37AECFE4233FF3767C36DD972C609915EA48FB0A40A10BED3",
          "F68B15BBAA2C3D896CBC8E71FC199C616838136633FB74DB6BA8DBCD", "C31C7A36653BBDDBF968B0AEB41A5AEB84DA39B1B19D8027BC942175",
          "5F77824DD65461EE271A186414F0202E50B0B37AE5052E2E2420AFEC", "B2FF53AFB014BAC783CDB47A3CE578CF2326B8BCA6B4E1BCA39384FC",
          "3FEEFA6FCA603D88BA28D37BEF789916F6AC7CDC84B98D9CFDDD857F", "67D1062983402ADC3DC5763EE0B5A01BDD05CCDA6201851B7737F99D",
          "B097326D5AE0F83DF32C178BA24BF6C1565C9D56B510580D5C5A4452", "FC643B5D96DCD47574F5C2A9DA41496E19581D61D36D0CA80EAC735B",
          "F16648B4DFF53D360E155002A70666D7C9590113DBC65AEA69090F0F", "E585714D886746979675C3E36348F288142FD651C1E90F650CCEC8B7",
          "1F86182762C51F138A8D0F9BE4D7A8E4343E7E9379628895279B12F2", "CA998D45874F678345CFE0DAD7E98087FE25F97E9655105CA8517FA5",
          "8E9367BE7922EE4B1C894E87E00336F85E3BDE888C272A927F2E9292", "FF1B3541BB79FBF4589702016177E8300002E3699F337A769C3775AF",
          "4CFCFC12008A315833D0DBE3FFCE392D3A3507555D0C08E8607D6675", "F248B11ECB5607B527D13BC17EB51C28D980AA43D1BFC6759EBC4EC4",
          "6D9903443C94920EE6DD70921C4B685BEC623CC63B94440BAB8E80ED", "8C3795797AC5CC4AA64BE5E127DE39B040ADD3D5AAEAF34FA16FD14C",
          "1F30AC40BE14D031156C72973F71A4913B05635E84FA49364197086B", "28F47295F37BDBD855EBAB224536A4D384146F8E090D836F322D0B5B",
          "38D105F2D84506BFC4DE24E52023725E747A9F3E187A2F79749A4400", "4D0FF08127DE9D4A25FC29430819CEC7D22154845123A9C329EC81A5",
          "C5D89928C8EC793F27AE235625CE06B36BC7A6212D4E5E154F278E6E", "FD0F87F6EC611D61BD04159695E03EAE03FAD45FED601CC3D4F4E954",
          "ED84305C25E312D1C4155DBA9AC2354F0722664E8C773EDA426148F8", "316DBEF070D737BC722B1B3FDC93AD54FC89649C2744E1FB54271F3F",
        ];
        h = std.checksum.SHA224();
        for(each k, v -> sha224_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.sha224(s * k) == v;
        }
        h = std.checksum.SHA224();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "96307C98E9D66B697E74E367A9227846DC53AF4B4828BF5F4513B62B";
        q.update("2");
        assert q.finish() == "0C9EAFEBDBC17E79B255EF8E276C31B41CF68D9351DD6BACEE098D48";

        assert std.checksum.sha224_file((__file>>3)+"txt") == "C03AF7AE28D85F983BA17671695015D0C45DA357DD635F5BD38DFEF9";
        assert catch( std.checksum.sha224_file("nonexistent") ) != null;

        // SHA-256
        const sha256_results = [
          "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855", "7D1A54127B222502F5B79B5FB0803061152A44F92B37E23C6527BAF665D4DA9A",
          "900EAC36EE15DB25D52B8066FE8278FF2ECFC573530F1D2C9B724B3077900C3E", "75A73050545F2DB3BD57976D4E7A616FC6A1E0A3BAA3905531FA4C124ECF2E6B",
          "05D0A8B2C9522A6F5340D9D975B61FED153656B6802067D392B2064FB81CA4E0", "3FC078E782AA8CA0DC7E2816934A16FB2C42F6E30AC30BA341FB1145CC557AFD",
          "1B2A2D8279D810ABE6ED6D669967798358CC15C0A3FDC5A43AB54F082D892CB7", "36C5AAD1C57AF017D3D516E550FD949EFAA08BCC658477D817A94C27FB8B6142",
          "2C5E9855C334F91FB7E058C692E4F170688BDA08446C22709989F01918AED323", "0CEA5CBFE2751C43C4FC33C19D51E19AF33D134DA6EA4C7B574DC7EA85C60B7E",
          "583AEDD211A41DA04411420371A3A4FF82A60ED61D683B881900CE21686B7269", "5CE757614430077D72004699CB365272999D3BF3ED9A9A55E204A604CD0DAF9A",
          "A21EBE50B16464003C077E086BC8CD1003455EA3585D60207C72AED9C74A2A6C", "1476037AD25F9834C460F444C213AAB402BFC4D3030A1633049C5C88CD7B3BB7",
          "11128A0B9404EB9079A0DB7B532FB622EDC8252ECC1A7DFB6550F061A1BFDF93", "E32D647F12A47694D6CEFC7C6C78C610C648DF293B0752D72251DD0E3338E69A",
          "33B2BB33C10BC5EEA0BC7C3CC48CF74504B3C1819FC50F82B08CA545A868E5A0", "6E7E0AB5669D28169F129F046B41DF9CBA881393A13D99E540AAB3FC96E25884",
          "DFD6C6BB4794BE8AEC24F9FB94FBFE21FBCD2C1E8541A7034B00A3FA7074AC6E", "B27FF73FD5B285B8DC07010868ADCCDE3B265C8ABD57AB659692623DA2235266",
          "478602C5DCCBFC1A50B8C23AD375B588BEC4AD4E9C05AF380339F0AD2AE9E5AF", "9BA401F6E767C64A0CFAFCB1557AC8838B40C54DCB48E8E81B418C95FA0903D0",
          "C73D85008C95DCA71476071974251A6B3E89A769BB14B1A85C4DF3BE6ABE5DED", "6B53F4D1B0B189E873661CFC309FAED68A8BC7D64432542AB3F5DC39FF24FBAD",
          "EA396D3B30DDA46C7765F80A4D95A96F3BF495C5E2D1B6A525F0DB8C99A49BF1", "4E8B7471654C6596872F506F8067EA9EEB77DE2495D1DDFEB6AC5BC59F031477",
          "9EE9582B5C6D792142000F621F2043686FE4716E58178ED8DD3B2626B76A4EB9", "7F4882497A496D4E96F00D1E97E18148E24A822394BD2FE216FC39B38B16C8B6",
          "1F8B26DD005083F4A87964508874D0612F5C952FAF3FF80F5312A95BA10FE2DB", "F347E95C200BF2D994CDBD051AA7680506ACB18D845A24A86A1AE43922E9BB90",
          "EF40DFF56E39774797A73D00382F31388A3E386D45F7545A624F9D75D1EB7A35", "05258895CBEFB5B081E6571CDA5C1E47BA6F70A51AA4C384679BA7C6BC89D158",
          "88DC008805F2D63DD54FFA3318CDEC4067E4C1C0625FD9E51FB04EBA8D84F596", "C426E780A387169E9D8F36FABA70792A4C8DDDC877CD9EDD43459DDBFDDFEDC7",
          "0F942A46447946EBCE01D542DDB5828E030A406E06F127DCCC8FA385A2CB8946", "307CEC625220871D103BE634961F0DAF6ECCEA03C13285434A0D6276977A69D8",
          "3D7824C3BFEAD991FFB9809DA04B9055F872CA943FECE6C1B98CA1E6C459D4F8", "CA34A347F21285CF72403FC5ACA05ECD2CA37D7C76100F0F5F283251EB3A61BB",
          "8D837498A3087D9C4CF175A270E9D6D9DFB7FDBC0CC713E10B8B98DC45BD12C5", "16E7A8FA7EBD2523412EB201F0370146AF9CAA5B880F7C46CCE311EFBDF6F986",
          "78838E1AD1A5FD09D12CE1C9AFA39D6A36A27A4A9D61C3C308BE10B4F8A29616", "3CBA195C61DDE8A42F6F4D70F06F620BD9C293D5768C93713DFD9860E8076A4A",
          "BE18F449FE0F72A3F00C8093ACDBA8E93EA262AA43549560C23D68F9D7530531", "4371568D8FD47F3287D8B4200E5C1D74D6016BB65E008036B7A7857C9EBC0FF1",
          "EF127EE139547AE18887D3B28F47D5B13D64CAE2259C29519677D47BE0AC6405", "C299F9DD68C35C6EDFFD294ACF70288C22773B8B9B61A2EDB37FB127211B6AB8",
          "2C6F0BAA06D55686E2E1BB731BBF08E64457AEA5900BA353127AD5896C82EEDC", "5302D878B343C51210443B8F5A262B031F3602CAD13D4AF665D7EDE69915E292",
          "6774C0CC7092FA25BCBE706B82C793B3292E00EE44D0C0C224F0780A3DB4A64F", "CDC87CED5AE9279F883A79EA25B05FB4C14A636C0E1D7ED5E70734E423AC6B8F",
          "4CB90E634D27F91B27173A5AC3AD4B76265336A61FECBCDC139779BA4BB63FBF", "A9A366010ADAC425E270879FBDB432A52504EFB26CA77BA471D5F0B7FBE3A589",
          "5B3E79546DED00D9CF63E3BBFC532F93ACA9A3829B51F4F83F8FE76020A5100C", "0571323B6B62DD3174E3D31BE7426848687992F035903FDE59A57CA219557A9A",
          "1749312208A18AFFB899E7760684502E21E44BFCF3D7BEB7FB967EAC6323E0EB", "F5440F6B219B145D90D4D9DDBA010719C8502AC626E3058D651FC1DCFF165ACA",
          "C1D5C74B31B73316664158296C171CB0D9F8DD682E7EE7C6A7B794EF7603247E", "21C0A48E3DFD11491249BEB2B39D3B0EC990A47E8A0A0B9344D489D70CD3D187",
          "D9BE36D70072A14AA8030DB9409A9A98FA82D4C9FDC76E20E27CF5F685B7FF1D", "EDB06E42095CC487145C73D5ECC389CD8D5C7201C25A44AD05D1A64CD7773118",
          "05A1357E3CE10B220E56B34C695A62B7689F470140CC5D132BCC3CF584E63BEB", "028FC45F19F80932CA26A6791FA42B278F3E332EA99B9DAFBC22B1CFE80F6CBA",
          "D31EDEB5E90BE2AAA0D6022907B5C4D55D485B9D75C1E24DAB878CD9C08E80B4", "035FB9DFCB5D5A0DD25F2A636340F60E2551A2641D56A18B70489463F72DF924",
          "FE4EC1ECF2BDF33A3E1DBF8C1A8448E3E7576EECEBC51AB22A82557534766955", "43C04591C926636E52927068E27C41140EBA352C236152794B52A08F36B64A11",
          "23A086947620588D7C2ACF4C074B32B71F12D45931AAE2C105419956432B5EC6", "6E58CD04B87E41D0354CD17FE5E3C2B77F3EE8662217F95240013D3B1E38BDFB",
          "D3E7A2BEA41193779652CFAF6A5B4C26CC380200D92933581BF1D90F95AAA7AD", "3B76E19239F010D63E63F10253F384E32A5827300D279991A1C143D00826D44D",
          "22119D4508BAF69F4DED365370438F311ADD7D57E4F9154FF9A30876E7663975", "5A9B6A69297B52AAD0E09F0A4870F3A5B264CAF08A81FF6B7B07D4DE6E4ACA7E",
          "98A6C7ABDA55BD7E3088A9F20F2C206F2847C2CE979875B5A829766DEC25F1E5", "FAFDBC65BDCF29E8F6033E205840969B3FA02A24139AE4BFC7EF64A238A5427C",
          "96D98E85CEC1BE22700C4817588AFC3B670BAE9BB7A284BD4DC27A3BAA89F480", "1222598F08A69AE4341F12CB2B855B17103282B901E890067724FC3211181387",
          "8FB07105D9C4DC0E7F7277B25F12308CC1D194BB665F006BF431963E700642B8", "0B6D64A8C5446B4EC3124A11D5BD40C520E4D8FADCDC70837FE9FADE0B7F597C",
          "C1E2FFE00BA13B121383CE8EED1E7FA198DD3DC27359BADD4AF1240717F3CD31", "9ADF1090398278568C24C0A0F86C694F7400C75B0C2A5F6A8D00171B2EB62BC1",
          "E49DE3BBCD069D91ADFF8679E6818F221F2F99FCAE647945B27A648ECB92EE43", "F63077AC53E6BAE6858C86A4777D51C23D50BBA0D98E56DA7DFB7EBDCEEEC5D2",
          "B2FB87AB63AFADE6ED35E55AED38E99DE4382E67485B54E8FBDEB9E52822F000", "7ED855235ABB33E15C5AE1B936FDD394C79F585A4ED1E11B482D5C0B97EB55CB",
          "A59C62399E294AFD9389950C8D610E8E5C27EE51284C03EB5DFBB75E16884A11", "3B53402260FBE0C0C2C96FB9A60EAF0696290D1B6A7E7C4A0B91890839908B03",
          "87439B9933F176F159B5E89AF5F0A676A165409A68FA63224EF56F9332113FEB", "DB141AF3F8AA5A1CE67F1D789AA5CA7A34104E94139A34EA92593BA62AB365D6",
          "FC8FB0892AB89DB5D8ADE46B2084FA3E55F764357EEEA0308C040D82EFA95C58", "47AA8CEAF6A06DF628B2275B4E7C3426E7CE1C17F9339AFA694113A8A319F5AD",
          "16EB24B9A4B8EBC9744B6F0BF2C2BCA1FF3175BD9B619A23E499E95BDFE9CA02", "BFDA054EFDEB50BE3B217B01C8889A2737F6AB44A03A106A79CED0B88A9FDCB9",
          "795F99E47E8FB588355B8EA537807DD91CF481AFCD0AFD220C35BB7E3B7A7B18", "5341667364F180F82F3BA153DC25F59D8C38611A1D9505FA3B0D81A6276D3F59",
          "B474F891E69EDFAFA5A8B776CDD4CAC7A491C1A0C13197F5FBF85AE4160115BB", "49FBC7D4E30F1FE11891DCF998F870010C468C0A7D4968BF9AB0E1A16A279BF0",
          "287F867A10797710C789A65BC4044B39AC05B75CBF4168FAE9AE5FA55A4FFE50", "50EE84CA77ABFDF8780543A8BC2CAAA7456846250C91F652A0815F6BD376098B",
          "F025B7ACB42DF61E4BEEB4946945C2DB1C3039B733F09BDB2A3D6F50F5EE6480", "D01965EC1D532B26634A93F5B14E3938EBC838F8C9FC3B64DABDDE955DD25932",
          "6BAFF87C194653E2AF9D174314E81ABE593E354FBE78E9C8B3C95B92CF2059FF", "0CE61FDC27857B5D7A331BE55028C5EB568397D874DC8BE191191D2FF8B6EDA2",
          "3674848B6F757754881CC69762F5ADAF039D7CFB0EE00C684CDAF46406F849E4", "0D74282E83982E140A7B08FA8728A6A7957FDA125838EA258478D2BAC9E4DCE7",
          "C2801661CDD7C3592C83D1C423AA95790A89738559F125A5EAB617B3C06C219F", "F37ADCD9B32F8EB79534E37D3B86FE87BA571569D06BB41BD22A0E43ECB49C60",
          "E3CEDE5D6E2B787E6D0440B2856552B3C754534E8D0A230A819C8B233528BD8A", "D238FA0A3ADBF048B272224F5F2B27738060B1085032ADB9296A8BD428966788",
          "8DFF09B509597C9FB7E9ACC1A5D297ADCE18C1BB65A8D63186D363846F833F6C", "B0C40EC77145CCCB7ADFAFEBE6963DC4197C3F132FA2D1A2D60064CC5137ED73",
          "E082D08C7E54C0C3FFC7F87B3DD476091C485F2E9106BD9F8693895698385248", "E2B1FF05B6CC71E8E6C63C679FB9040DE3E7A4B2CBEC553BD5B3A105CCCD4BD2",
          "09EBD8E510FE4D57437C1CD0541719DE59250235768172C254B3BD1760C33E1C", "A14602C568C53A66C2C2022BBC724D4DB6D3D7B554E77A0D9714B8EDF0CADB7C",
          "79547DB658AB9C6E18EF1954AC66271BC4AC301570837FBB58BB73C78526841B", "C4F9306A08C89B3D02B0AAD5F30034067F1DB1C509F03AC3D07B923801048F68",
          "8171FFF8997302078DDBE5A3757581995265C04F68FAED098742034170085DE5", "8C4973F47D1D0A7B315D1FA031645FC629E809BA74C00FD288F0D9EBFD609E23",
          "ECB0E0FC1D3A0715AF3E708CFF019D517051862B81841D23D867CD6006160CDC", "AA71DD0625EA16F0619E672A546ECB29814FC6EDA268020DC3C21E6B8720B3A0",
          "605EA1B5DFBCA577D0624A01E9A9B842C69191CAE1794ACA47E54A4ED6ACF0E1", "45864B11E7E2C803B89901EC4F5386714C180ED9036C61945FBDBD2D7FC55ADE",
          "A88FABE4AA404E694A0989A46716DF6EE2E2895A56E898A48253A7FEE2BB56EF", "5DC9818474866E2BF08927384A7968F0B53305FD45CF82535AA43FE65F7D51E2",
          "8955764CC5583DA76BF36304BB7D1C61FAFDE3D619C301DDB2E91BEAD98FC09A", "CA2BE7BEAE3579FA2C951F03E03887503057DE8496F728D8EA899C6E5531F500",
          "D1E3F06B406DEEC956B84C108140A1C8532304B5BB7498EB744B20C57EDFAB12", "5E1094168FB46C75DC57FFF81E032657C217D98B4058BDB773DFAB537AEB0954",
        ];
        h = std.checksum.SHA256();
        for(each k, v -> sha256_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.sha256(s * k) == v;
        }
        h = std.checksum.SHA256();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "91E9240F415223982EDC345532630710E94A7F52CD5F48F5EE1AFC555078F0AB";
        q.update("2");
        assert q.finish() == "87298CC2F31FBA73181EA2A9E6EF10DCE21ED95E98BDAC9C4E1504EA16F486E4";

        assert std.checksum.sha256_file((__file>>3)+"txt") == "F5C962601B413CCDA2FC14D64D98479D9FC74C90C2DDE15F25EE9922E57F5074";
        assert catch( std.checksum.sha256_file("nonexistent") ) != null;

        // SHA-384
        const sha384_results = [
          "38B060A751AC96384CD9327EB1B1E36A21FDB71114BE07434C0CC7BF63F6E1DA274EDEBFE76F65FBD51AD2F14898B95B",
          "9F11FC131123F844C1226F429B6A0A6AF0525D9F40F056C7FC16CDF1B06BDA08E302554417A59FA7DCF6247421959D22",
          "DD75C5B1E267BEBDD631915D2A3C12989CF9876EDB19F99E362954E0F8790FAD55CAE96CB1257C70FFA98C9019FBFD59",
          "7F459960B3CE8257D74CCA8101AFDFFBA4AB364214CA1E0526919354E9CB3E7B0DDEE3E7CD6F23A452D19253E424F201",
          "1ADA7B75F8E4F829EB51E45147D339B8822E3C5BB378094AB02B2AA108E6B7D8EA90761F0D653BCE42B34CF36B231D94",
          "7E8FA1D5E3D21FB85E936E8B20ACAB7846E7B571993F179DEB5A71B3893182F4F8349EFE4B1FA4CD2FBBA4FFE786ED38",
          "32A866811677BE500A99C83FCF14C4A7F4D4594FEE5BEABB98742CB8A70FF941265D3475E83F38F09EC464951D862811",
          "2CC2AF69DA5B40E42A89359A0FA26D937BB746252D21B0EE640E257BB8343DDEA28B4F1C53BF330FEC37C7F11338CD1E",
          "62E0C9511F17A5590F96D1577EDFE5FAA58B3C57F1EFCE04ACF66F483921E0EA1BACA962B37A63321D62816926659CEE",
          "BD807AEF0A0C8DD368552807C3BC9A154F29CF2FD1A7955852088BC63EAFD837B60B4159431A21309CE638631F0D875D",
          "835EBA31BD3E20E602DDA48EF7168777435840E88318F7AACCB1FB629A5DC179C9425AC1CC42CE5CF8ADEFACA71FDA1B",
          "CBD4EA81413925787AD0F0316165EDF78E4623F5D6F6463BE1D3A67882F53D744E782A5D935CA420FCA987B2366AEA77",
          "2E36A8C2C5D56A2C0E0348D9FEE16894907F3B17D8D7F94D314111F661E433745AE98FE61BFAF93E8B12329A8F3F7532",
          "17589136E4F9DB4AEC616837B1EE29B9B1A60A08E8DC8F9B3FC794A689B762850BC148166A1EE7488CD20134F0ABF703",
          "593E210A93CD919C95F9B6F62AB0153CCE78DC7993BF01B0572618859B1A298F2F3C56BEFC6386CF9D7B8CED451CA959",
          "660465025367F1946E4B69ADC35D083C67725BBFC4BE0B1FD2FA809DC392CC1814C5FC0553AEAB849E33EA9F9E39CFFE",
          "684BE2B76DFD0536E69D1F89279892FB9F8A412870D78404C109D71B81D77E79796145ECFCFCC683BA02F5DCB7B2FC85",
          "FE1C99C498E5A0CFE64123F2415FE74BACA9310BBF5033D3A4D62BC9B7F0D7C686C3665D682DE9C24E5A0DA13D7A5005",
          "61CAD2421B8DB2FEF7ACA71D42CBC47FF7F71863DEFE8172859CDB586B27711BEC3271F02B7C6F7EF6C97D06377F74AD",
          "5CB78FDEEEC882AF329F87685A9E48E37BF18372C4525C7B4B3DB0C2C0DD563B7E783D48F5E3DDF0593E2EF5CEA5E864",
          "0B0557177001BA48097BDBB968A43D7B64FB13CDED1256863641E377BCD08E0FFF8FFBC21C11468C0D45286799513116",
          "B1C723283A688422860F78C3B554B03F2CECBA0CA0CD608F189B1BB5DD84950DF5E93ECC0BF4D3112A58360499B5B3B4",
          "499946C261C8962819871832F6210516E14083EB5B81337953C3316BB3D1C66275456307071041C76AACC8206E30B8D5",
          "3730B9303569B8FF82E9BAD41769B7696B897F01FE39F95368645F201A13E2ABD0253DD5EEC355E68026017C75B4CBAE",
          "EDA30EDFD8FEB4253113A02D4B4CF2FBBA2CDB2E257C05834EB8EE5193EF2DB15B7C54227B6C18A0DE15101FCD6940E9",
          "AC152B21DF0287DDA828FAF7922161C0A0053194C6BB18F1CB09E299F015BC40AD8F4DE27709A1ED8BF60A9A25CF34A9",
          "30A666F3F7047FF885E319D87C022CFCC1683202912C6A1E36016A990361924BF360223D4BA5FEF299C2AF43371067EF",
          "1A1575CF55B8B9D6B862D6DF45DC120B2A212234C3252D4EB4C2EA9CDBC174ADE164115CB96369562C93470834D49763",
          "1045B5A14E8A318DF4B8EA6D5B80D756F3E3C401287961F91F72E134952234FDF3656B6EE0D762C0CF819209280CE977",
          "706AE623B48FC93FEEF8E95911877F00FCF94BF41A72B108B0A571FF3A3EBF65CF3AB0BDFD0C22F46EDDF83B925C34C2",
          "DBCCFBC6E774BDBCFC49053D0CBA391C3890FC63B53BD807B2117AAF282B24FD313B516EEBC5225729CF10D663FFAC41",
          "F4C49A575CD342AC6BC480A16EB14C67A745AE621BFEE0955A72C8657461CD51C8B78AE35AD0CDCF76951ACB1C489E15",
          "65C986A9FC633F6CCF12EC6F237509FC979D3D317CBBB8C6F62607E468A56742BB68E5723FC2950C353A80D7F56F3B68",
          "4483B5D8DD23DDBEE003A4142F4B96F609087EECD42742D1173A867A07C37A1E2934678ADC9E3A1122A04ED69DB5AA01",
          "A4C2F3333B5567E06F0569E959D756B56C5E5C9B3D7C4F8F17F15B21B4F713392617DF4792E2754C5531092BA0ED5C69",
          "726A068FBDF3FE24A1493F6F572B1CD9B329420FAE3E09389F41FB3B8EC65D28AF139C9AA90ED7E1C0CC7230DDEE0DC2",
          "996239A81049A48984975ABCF7D085B787F591321BF6D41AFA7CC3720BABBF6AF340212D4E0FE60D4D4E7D4796130DBB",
          "8DE88EF1B98DA502F65DC6D38810813D086B24D331FE2D4D38DF4063256FBD3D09CC6D608984750101C2C9CED77D7720",
          "0DEE53060DADAF380DD4507C0588D1014E2378B908B5DF857558D9304F8B02D2905093F93E413CAE6C75FE617AA6630C",
          "54508647FCFC298646791535DE20590B0224AA63F94743CAA43528DB6AC6D510E67CB42D4E0DD8DFBC6ED2939D1A765C",
          "1F869C3DC2780EA1B3F1D1391608487CB528F6F0A6D19FE30333BC46B5CAF96B8CFBDE5984CAACD6256AC3837C370CBA",
          "63F4631A13FFB002C9F37F52E5968AE1325D608F7E3EFB2F24C5536D74B4A4DB2B72BFEAC0450E151D0DBC465F7D65D8",
          "36079C76E2141FC36C611C7AE2BCC01ADEFE8B54782CF2F1E6C4AE84DD0322D62A317755221BBC4CD151AD1D765AB204",
          "0B8F245E9BF9864D91EAD32CC8F69F1E32ACD0C70DA23FC14B3C0F760737ADFFB380961A3AFBC6DCC856507525A1F640",
          "FDCC695DF6DF2B48D4A999F801F0CD25BF73BCB9F66A2757FEFEF477C65D9D05A45B0E77E040CAA74209C56681C0C70C",
          "57083B59BF754F870436F86B770801E282149CBBA40391F5CEC39FE80A8B3696BEAF47C198D496ADAB37EAD916889A20",
          "A529BFA0E6ECC7B4510C4D0B09872F9E960E2CFF0320BC42AD243B719DDF63990540C4AC16AB10050C67784D1D0B6944",
          "0ACB07F5B41EB1E1FF43B006916990E598B7395C8128ACA3F593ED940865CC3F1F33CD7030AC17D092A48AE0B3397F08",
          "300A98ACD4F8D4857019121D78503A5A49C688115DAF4380214BC6E84ABD4FAC38E3DD3AF1D4A11E154B7615D9F90D9D",
          "5A6BED8C646CB55DE5769FA96255E3A7D245B2268C279E989F4AB7021BC17F3681FAA11517CEE39FF66218DBB76D3819",
          "3EAA4F88CB16921AA0276DDAF6F88F08D39C3606CE7664A680D1E7A2284C2AAFBD4C47958F3E9F426F15121A8548B8A8",
          "A97CF2D13FD374077B2A4D2B9D2EBACDCD47A5CD5680E8DD58A4976706E7C6316654FC1B705D0ECB34DE36FBE1C8A146",
          "819525EC2E73FA736869C65F0043CBC9EF4579348CD48E8469030E8045FD081F65E75AF276A0F3D237B1BAA6E197FD9F",
          "C48D1B9DC5581F928EE367F8939C7E478098B0B42D941C590EB623AB0BD1689BDF2BAA1DA657134489F2E244C79F21B5",
          "BD48133B51B9C7EBD5F159E77E4A0FE7E60F2E923A376C61E31532FB27EC62B4997BEF000B631FEE616313C515F794DC",
          "D3CE681885D6C66FDEC6875F1B77F8C9780429733854BB692E42ABDFE2E0DF968E7F707BD5DEEBA84527E596181337C3",
          "F52FD7865314265E8C5B89AAAB602B34BAA9AA2C77AB0D9EF0C4C15BD71FFF45419D6E557C8A61113BB21389A6ED54DA",
          "9EBDB10355E742B2E68539FDA208C7F0F0138087A76A960B1C45AAEC39B326A6CFC9C93522BF0397BBA5E8A9300FDA0F",
          "F2B3F47BDA6E97528AC9EDCAF88CC2266CA37EF7E65CF05BB680037FD8BD30D58162203AA96FE3084D689B1D19A0F674",
          "7CE63381F98BF8501BA9AF84DCB924CC4A2588F9A9C1FE74413F98C2DDB8B4F01E9B0E4AF1F49E675721504DD0CEEE55",
          "75D1B9065E98A37CC13DD445BA1CFE74D0AF1DEDDCEF3218B580FCA840DDD1CA496273F1ED646FCB00B5204B53277FBA",
          "B1CDE47F658AD52CA7F17803A6FC6F0DC5D837ADEE65B01BEBA49CE94AA625DB919B463EA11155AD7CE242166F0D9C6D",
          "D5B1856DE69AD13D58B58ACD42302754B5F207A0A2E55EC0E0A09BF157EF227C61E7016203418D573C50A7CDBA4B1E73",
          "E8C41116D62B725FDC06B6A67F0A46CAA54168DA383B43B4DBC9816C4AEE106A535F755D67F1AF1B6E0BC6F100906657",
          "E021AE5A90E608CCC08166B95583F886CD4D5C1F4CC9C28BEB6B3A04476F606ECF482F9825F748B89151704B5D5D68EE",
          "E5F633FA302B95661EF43DC0955AF0D6B328DD27337D4B9F849E8AEEE9BB7A18A8EC34595E6C3B166B5D3C6D3C0CD8A1",
          "3D0074F91292F5C72FB96C51B76B5D089F1EE2D0F64CF681698EDBF41D3BD80DBFAAB6719D971AB5ACFCC488FFA64071",
          "4B8F1172FFAE428063E09F1B992CA55423BF2A82CAA81CFAE5C05DF752A945957FFA5561A1151D1D78BF73D2F2DBB379",
          "1956F9E520AEFDB6365719D9BB9D550331B59AC7559D9973218ACB96A46AD011971A0BA262071F6907AA5537A85DADAE",
          "FF6670FC41573940CBC99B3CF789A7D8B8D7DC2A14BD9745FFE010FAF0A49D45481DCD0B2071143812A4AF14E19012CA",
          "6DB9D830A0432955ECC81C7A8F9E0C49F0CD7820C103C29C672DDD6342692DCF6234AED39C95376CE72FA925E6EAC3D5",
          "5F6C4A0627CF29B2C4F5BAC70578D8BB5C1487B90105B70B6FD835CCFF56AA688EECA70A2188CF5BDA9B45C1D159EA77",
          "928C2DF4519BFF6D34FF79332FA6C4D640984A4F5485077B529285FB895980575790E0D111D96B92CE47F7D6EDCFC323",
          "3741FD3CD337432D640E4E7F7AA24CF5203413AFA593E29DC11071227114B57EB82C4C68199FFB686303E690881C452C",
          "418BEEF53EBD8FE225B11ED15B98D36858B2A6FADA7763249D5D803062DF79C5B4E331DE5A98F394885034BCA83F1998",
          "F4CD5E24C897EAA92F85FB1C52E89BD4AB4921AA60AAB68DEF3890DA43B70C53A480EF38314808C142EA9717B8E83B52",
          "0B46ACA921496F77C97C4D78CE961831370AC2EFBCB2B1D0CF4E7B807FAF6207E5FD2628A027DA93A0FA3BFC1AC8212C",
          "131FB911A9910625AAE1BE96B6BF1F310350FC4741C105B18D02B38025DBCF4FDC0C18BFB57745D0684DD633EC6EB397",
          "71B2B5A68B11F4E9279F22F77E671A26C564C3688C2BD2EBBD590FD148745AD7B07002277925A7EEFBEABCF7FCDE6BF6",
          "18A1A80D3B9D7AA8D79ECA7172741E26750254C1AE69739C09BE824395FA60F71BC51E140E222C4285DA342BBF8A5F22",
          "8601A6D9E2B8CC9646B43B779799F8047D22970451F10726AE41B14528496971A421299798F8F9AB1B7AA8F0F87C7141",
          "D5F7DE6FF500B48D137D0FCBC5FD791DCED1812DA5C59703335DE03AC009D656B3AC29C6E7A9A1F41036A720C1DF0994",
          "CBE1DBBBC66995FDA66FFABB042CABBE99F0EEFC749FA3857DCE760A9E6BD6E71D4F8CB9CA0D0F21A36EC2A1AFEA8A7A",
          "65B2FEDE65E51AF86B62AD1ADB2EB1634F5EA98F781F2827F39C91236E35443A23EFAE4A61D18C7A54892E45E9948488",
          "A6E9475F647560DAE13D8F4ED07EFC7E97E942E9BC9DD419D47612FC30D3F3FDBE305241891498B0CC6C3B93BCEF197D",
          "1EDBC82CBB44B054DBD415549EF7F093274F895BBD6D721D9D8AD3101087C9BA005963129B8BAB5E2FC75725C474F20A",
          "A62F3E6D7BB8AF8AE310AE41368B2C908BE0857E2D74D9FEDCF5AAF26AEF5EB2F55DFBBB95A5D8F4597DEA598AB71702",
          "FFE3C9EC09D40A6961D918A18293BE8E7B5F4FF1852C31CED66096C7F5D9E37041F4EE1279053AA963F5069034BDC2D5",
          "9085CD276CF3AB65A5305AB0463997C0EDD52D35C8FE95B5DA3D805831D7623D7F0D3691B90F14BFE0BF25B9ADEE92CC",
          "686318399A1AFD865B203B73F2B6D35DFBDB3504204B032B069C6B08DF282C329FC061A40ADDF59EE880AA6AABD94B04",
          "119EF272547B7FF1DB4B56F95740DC6984238855A978EBA332C5D9EBFD6BF1162DC6E1AB36E38AE71AC64D217E76FAE4",
          "8EB28C3FC35B8CD94B281A95D35D7400A62DAFEEFACB4EA9753D7F4368B4B4A07DDF3D6FED5643F2F96B6260D06FF92C",
          "FF9CB4031BBED92FBCF653E791CFB369D680FF01BC9CF689A16E79374D442655C5F7956A459DD1F067981652EED26FC6",
          "C9342DC1874DDF75F3B430D514547D1CCBABFBDBD4E3C6A876D2B2B977971B0AFED41B3A5A44260BDFCA0C814BE3D19D",
          "9E9C5C6502F50C70AF6D06A617FD5F857C90C4CE51D513195AFB0EA0AF947D5D8256D1571DEECA59BC72CC98D55D8773",
          "6C1656CBB3141E808025F99873B4337F221E4B1CFE86B6A0DD4890737EE76674621A63D37238BD30A835C0D781809BA1",
          "7F1E9FD683B45EFEAE109614894F735D30DE5512E78DDD55CDA7D2132711E87ABFA8258D63135261C6325EA6FCB69A1A",
          "3E230F9D7926C56D205F4D0DBB9387BAFEA4C44DC955411CA9A5CC3A286534A0CB323313C165069DE6A0D173FC9C7206",
          "4E1F8C606CA3ECECA20AB024F7BA802E2C6BA12B44963D8077A35BB4CEFBA1B680E6E3AC04C2264A907141B88B13EA64",
          "1CE3E969E584C9D52A11492C53F04ED9E730CD0E66FCDED3312B4BACD9AE911E0761704D2F40825256CEEB21D71C420C",
          "19BF9148046CA211AFA08A5606FC597F2A89BDAA8345C59B7E814E7CA121E62B3AFBC7BFBD3417D1B50B2F7A8F06061D",
          "227FD23C6168BCC877AD96F1617800D391B8C06FC21D41ECE7594EE74B5AA4AD7D3C3AE33E328C79192B85839D03E97C",
          "B309155AAC7B7BBCE818B381F3116964AE5BEE4D0D8356BA42B5CE4E6FB4EF35913071A037347DD3415CA1D75E61B482",
          "780680FF4750FF2C2C001321BAED375351273EB3A1F0BEDA05845FF97810D625AB0F4A2BBE6F0B8628BE369C0D75231C",
          "7D19B16835C78FBFC2309D4413009364EA66C09D0C7C0A5211F376952F9F7739AC9B2201275A54BD9A89A052CC882748",
          "685D1D4B2613FB642FDD2191076E188E032D778DB3455D530D1B391482A7A7B78A43D95D3EC3F87024BC74175C2844A4",
          "7514C70363A1DEEC927ABAF13A9E2367AF8A9B481B2AD928468E527394B78E7438DAE5C4279F0BE2DBC90D64CBE63D00",
          "240BE800EEF770BD07B2EEE6A6CC00C06AEF8A275ABA37FC49DA818D32A4543D4524677569DE6B9456436DA9CEB4E710",
          "A4D17FBDE76182E996AF70CF1C22E44DDE106B8464CF50229128447922F56AC4958FB175ADDFA1B6D910F118041C73B6",
          "B1AB2CD6D5FAE9547E6DFEE662A50D969F1B485C71AD521DFF5B1E43DAFFCC3FD704800712E9C7178871E29F62E63349",
          "62D2B2519413747396807B3B0846C8034C56D4C664D984C3EA5EB8E468AB732477AE5B28FC3708F0CA1A589E9876F2B3",
          "15C92495B320F96FD0B00DD378E27BF79EAC5611587FF91D8C1151D12171AAF937DD9068DD17CF4E2A26276F678A0A9E",
          "0DB547BE15E5AF8DF1D389EE747024366404A78B645446070D557AEA781EBFFC41025875913D160E9874C81774AC0BBB",
          "18B0B03031BB78959BC6265DD3ACEA441E7E84E4CDA6BD5F9A5C794C1707CAA875C78D62CBE1D3071A08B40E97AC08CA",
          "1DB6F097A92E85C286881AF140D34D856D2323F03E6F1D3451AEE9331CCA35141B92A47C3C530A368F871E23806B5F22",
          "DA3355D83D9346D227EF21FC33E6739D76889D016363128643BC5E0BA17D1F514AA268D95840FC110FB8C6EFD5BE0B0A",
          "954D2F806B96DF97512BC81E161A80630DA0DBDBD817052C01AF0EEB1E7E31F3363C61CA490D24E9E6C70E10BED051BA",
          "FE8A6A649EB02B436BD085A74DF1042F84B35BBBB9F17277EA18AF1E5CD9720D63CF2CE65EAD199B0DDAF79D9E41BBA3",
          "F3712F521E2C6C5B2F7CBD412590F8CD670854C1671041B301908A419973E1C6534EB0982232592361C7B921D70343E1",
          "5F6C9936FC5008C9F50EAD8129B2A91195E5A38FC5C4E97CE437E62BE3DCFF0B526DE3E298DDD272C71F6FF3054D7ABE",
          "DED6B0CCBC0756F0336C069283F667B3C7C663D333B520EF116019CA2FE1960DF52E05EA42F513489F96F5BA1D400DFD",
          "5D3DE02C1B2935EBCBE5ABEDA05E4D4ACD088371C5866D3DBBF6D19DBE85D4A0BE90E525383A74696DD74340DAEE802F",
          "C5DC6160563251B5E5785561F3DC06322C96EA63A198D6E987B0469A8066B9A8CBFD65420437E85984C568D06004E253",
          "20535C4A5283AD1C2FACDC79CFC76D6B03D456D189DC93F3EF7C9C784FB82B98F8E4E6801BFE904FA764061AEC0D16CB",
          "E2B295E8C5F59E14C7F0A91C3ED66179983AC3E452E8909E14847DABDB49E0310F9F79BB7967E174A07B1E15E8E27917",
          "1EA2007AAAED7391BC7036C9630A48813E77AC47A4104ABE6D07BC4458B4CA7B98F43BB854D1C516BFA0015CC67ECB8B",
          "D023974DD370FAEA17990F2F247CD4EEA1D0D02F1C9C9EEF94D2EBFBA3428676F6135E5A03F5E580B2382B96EF3A767F",
          "81788842CD093663EC92F1A72CBECD2C2D82A9AF5B07E5F8C3ACC2CD2C1916F9EF607A094DB14FE8D960835B7D5FDF0A",
        ];
        h = std.checksum.SHA384();
        for(each k, v -> sha384_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.sha384(s * k) == v;
        }
        h = std.checksum.SHA384();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "7A79ADA28C7218353974345BFC7C2C463577219DC4ECC155341E770CE235634C7F5224BF586E51FE6D890CFE41E1C59A";
        q.update("2");
        assert q.finish() == "BA423F007E2636D0826BE479FFF8F0C15EB25402404FE0CC7431EF47230A58383B5EBABE4D0CB5B266F084707436713E";

        assert std.checksum.sha384_file((__file>>3)+"txt") == "006A7DB63405B7B952A1F1461F106EC9EDE283212D21019FCD3B540C213AB5D7FB236DB9EFFE8423DFB7330459C0894E";
        assert catch( std.checksum.sha384_file("nonexistent") ) != null;

        // SHA-512
        const sha512_results = [
          "CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E",
          "D716A4188569B68AB1B6DFAC178E570114CDF0EA3A1CC0E31486C3E41241BC6A76424E8C37AB26F096FC85EF9886C8CB634187F4FDDFF645FB099F1FF54C6B8C",
          "A05D6B03026095965E4AFF96A282451D17F3A725C2085F97A7CD8E3F00CE9A6DF15D40C66D03B25F1733212D1C6F7034DF530AF9CF925BECFEC881992A0B8920",
          "D9034D4DC4C9ECE4ADF986547E6B7458A69CBFCC0F583D7C1278014CDBF5E5ECABF4276941CFC9684AD7D990C0D31B533B2DE18FF7DF67F39405938F271D9EE0",
          "0AF6C63CAE9FCF311D4BF00228387527AE2C3B0A61A270E3A64D21B1FB1AA751058ECE7D82E6E26481E741142404287067022897BCF61A1D45E413746470E177",
          "B41958EF7CB25C0856B6D680692BE7E357D9C216DD2347C039CD454E962002303CF7B4D2E76B77AC1B0FC3BE3AA3FA9219133B5733CDCFB3C0DCB905E26A2844",
          "2E5FB3814C5A6BE86AB75035DECF2A0CB71740B75F5BC6EFCE0715515D72B11C8203AEA5D6522E2D6F3EF6BE6B7E62DDAC76E0FA70364B2B20927077BB973C0F",
          "968BB36EB0C2E7F9A3E025A16434010489734112DEC62A98A2EAD692C7240195312A6E473AEBD6F9CD049D35823755D1942DD16F25573BC3B2D93643DB0571E2",
          "51F47729C642003F4EF2704CDF232C62901C45F3AC750D522280641BA1A91EA40229731694D4B4B8642F812E374850EB8EDC3DB8ACF70083A365DE63BEAD96A4",
          "309C537F6F6571875C95239081F26BB0A8B6DD51943397DD982EF7CB253EC7260B54FFC85EE82C47B893510213E5C03FF2616B6263FF38BF6C0AA001CED14E9F",
          "8F216ACB06574B2EE670AFAF3AAA747F69C98579656601FE4E57796E8CD6561AFEEA11FCCC635F5D8A61A15DD9BC9D6904F79EB84968AD3B5FD8D89E82F7B9C5",
          "2A3441DCBA1477F66665B73784E85C0F065EAF42715C3A455AA23EB3494C1D40EAA0600C98458CDF530C75AD7241864E4FBC905B43E04FB0D21FD494C9FA2EF5",
          "C45B7871FBD13DA7D05E80C2DD783EF320025042FA6A5BE329F8AD4685004BA7BFB5C156CCB9D70B2C9780198F1C8FEAE28933F38E5C8D07298FB05BD7A29E0A",
          "EDA63BB5CD9A84AF892EA2336C6434B9B4431E7CE2297CB5D68DE15A839AA1A25416370532C454EE13B732A9319E18913A4055F6E9B0884BD9E01EF677F7DB4D",
          "7EC2E1B90DE012BD806E94375FBF7796C328C740CBF8DA78B1236BFA527160E8362AD58573F62A1DC233EB570FD5002E570B8AB719285B45527289B8F0071668",
          "17B5F4C4CE5AB0D150D5BC487509EEFCCFEC2F47D8C0D81168D48339F7C2F3042E8521F3641496CFE72ACE66B0369B0D602CC6AC3A5B40FB8A1277C66ED53C42",
          "916E3C429D4CACCA23EF9B09E2DFB943C636E04CEEFC7277CE5B2EF7CBEF5148F7B85624E537927F265F0713BA32AF343D1379B4CD986F66603FDE9D92956F55",
          "A1D55BE8EF64A90C98DAC2CCAFE0FF222D45D313CFEA905C0A75BE6E7961788EB0553D92A6DDCA169109992FFFED78612C6262A1A8C8365DC755EA4F803806E2",
          "E9A71DD23B20CBCBCF162134BC1D951112B09F3FEFEDEFBE4B16F4024312A49EE443E22E58980D2662CA32609203A9B66B884B36FC2B3AE15413F67023BF2FE5",
          "3E9BB95493D0B25C875BC472835216DBDC167F21D87BCC66BDCF28DE9BF358052B23AD7FA6154F7D33C20898875C04B9C02EC686FF0AE9FDD15BC06A9EA70165",
          "9A0F21BB1D96CBB1B5BD0AF24D528FD8646EA988E92D50597DC5E246F52DB1F8CC597C05644B598A4BDF9936B4DE81943662E30643859DC6B98B04E81ED5478A",
          "8EDAF4D295B2E8908BEB1B7B410D9538F64B6F7ADA635EE18F73439D911347AE45BF8A11E3F24260844C62F40FF407EA83E9B6A61E146947B21F5CD646DF485B",
          "1A1950A07055CAB95CCED6BC5B29FA3FF03ECAF3377A9AE32F660CFF0B653A8D283F3E60F91271E699826526ABF2217B6FA664968437A1A5AAF1940FC02DCD3F",
          "58DCF0278886A535F9882C2A73B570C958E750A3BF2CA7F3B26EBA4C75CFF2B8F4CDA0D3DC285A47B0BBCF7FD461739D21659E9321E4D9D1BF7CD0F2CC42F28B",
          "0D20671F025FDC9CD57FCE3E28C545F8566D95F3F68BB5B459EF2BDD1C601AD39B9AF16B3283E34C19C3BFA8FE5CEE17DBE87C699D1C59B5489F04B59A11A710",
          "4F701D2E9BFE505495065A3BFF172FCCB8A8A99FE52F203BEEF6CD0A3550E7229AD99DEDDDB45F1BC7DABF35186E66A76A8531E6153F9636B4E65BBC6DB4E6B1",
          "C45003C3620368E3643FA0C6EE46EB8EEE984789567B85DF55CF7C03E1D85E3B75F40AF594F2F44BD16880900EBC57F22312230196EB4530EAF786550959CD2E",
          "2C4DC90D4C4CBB4C611EE39EBBD37F193E47DB8585BB6C7B1B2546E8948FDEFB255E3EEBB39ABB30040EB7C31C1DE3167DBC884CB6A353E7BC6ABE336B4F8F60",
          "5F0905394007DF895335131760763FF5DE793903E00201839DF7EE8D9FE7D47D2ADD4FA246779E949F19473F5C75A2B8C38BB9CBF6B35E152D2542B0E2F98E4A",
          "231A5A8D5474A9B3734BF0BC94E09FB2CE88BAA83BB606472087D9502483A5776DD1E7F8DE82AE2FD32383E1C0AFEC23F08B98786C0FD75C079AE4594651185A",
          "401A680BA8153CF0BD3D891EFB6B757AFF79E2D5E1EB1A1C6EBA3ED4E6A9EA7955739D505549850A5D8477815E30BF1BF2CE4A07B52E55C62C8C3126505B3635",
          "1E9062EC7AF38BA5B298325B00EAA66FDA0016E32D53D699A212AC4D91593C7AC35F75B0F432380D4F6CE8AB47B7D1B4CCC453ECA2E944B235C60A04572B2181",
          "CDC295A6F746692971146C67C8E024ABEEF608D656EF239A2E3513FC14D2F42087A94ECF5834F18F93DD970111A77D2E5E981E9FD16AAA3ABFE70FDB8AE56A39",
          "3736EE83CB2A4A2F2AF3EC3057F126FD11E48882542638622CF06872AECE8A127408C75A3A7CED1EF33F2FF9D1BDCE2A90441930D4E6DC5970DFF3EAB8776A88",
          "9AE399BA56865CAFB9B06B3EF4BF84EB89F854DF606FBBF959359BB7053378427FE25D594A74A9A114104E3F082B19E26085D9981737C20FE63D24E542A534AD",
          "9B1C6F8FE7DC72AE18580431E2F276722E20FC6CF599DC7C1AE35C0E5E4AFC6854811BA7984C314B35B39B5BCF9758D5724B2753C89FDBAC3E0DD650345AD2EC",
          "903F1A60429901501619E993ECE01A77E46EA74D1247B9F675774A0C4952FB1413CB72C0CA45CB0E880CD0F09CE71E4B30635D52131CA54565A95593E4A9677C",
          "04131FAC10FE84A6C3D67E9B85545DC57447E482350D52737B0523C0A35AA460F1300B772E9D8BDEA71E54F2BB7C4015B9066FDD27A4D66497D18C91ECD8948B",
          "C8F9BE41EC19076FE174EC9E4453E68F0B2F88756EAAB857DD241636EF82327A19D88F0669511F249082912494046C3CC9F5B4C0823C3C7C00A6E56C0EDD9D03",
          "5256D2A2840F30716EE8A0ABEF89E06E8982EDA9BF67284F85AC8E155121E6B7DC3703FE424DAA8ED97A3DEF1831C03283AD54CC2680569130733C538A182065",
          "3E007BE5FBACCE12E2710AC85EFECD625B67FAD59F7B3F91F3B8F176DA00949DE2361FFCDF93FF6F1F1441CD5623020361DCA97D1E5032B035DB098D479CB80A",
          "AC5EF43B7924101B16BC93827DFADD8726D0D22CDE5AC220E847ADC0F33E6A41A2C38D146EF3509F2B164B94F7432F0FD84FBC36A4733262999BF6FD97533793",
          "A9454EAD633D527A9D67842E92C3F7F59A94F7A6EF4914F9311F298B87711A6E9FF9020699FA157DDC332320268F0D1E078A8F049591165EE414C46961517A1B",
          "AD6A2C64625EA81080582033A79F8005E3EF9A813255A9AFF3CE4416A72E92FC60ED38632D6C5802D88B1C5A967C7FC49680196E5064D9E15AE3E280F785061A",
          "07FF45F9AE1C262D21C91FC10582EDC3CF102F250156734C987085D848406BA024D356CFD2FA9DA846FC44AFBEE75D50526A82A4B5E59A63DF75B637125BD88B",
          "9712705B255229BBE101D028F48C8E38214E5C94F7C6AF8950707990F83AC670B50DCF2A705807394708AE55ED26107C835A95211BD1892DAFF2AEEDE3B207C2",
          "49FEBBF013861A1D0874CD3127CBFF561EA1389366F3C794D79334E5AD98C839813B702BCEF8D2AAB597100BF886F29D8F718F0CE8ECEA7CF652D8789556513F",
          "D89A9812AFA9AC7C34EB5F96811BC5A6ED5FF812B8A096CEF9004CB1EA07CF97A1D2100B2033F5F2856468146EED2FF4F1760585AAF4B3D909385E0FD1D67988",
          "75116D6EEFFB3D245A569F838C804B27E77A7B665A1662D4C0579BC7E7DB65FBA13D1C3FA949BA319D833F2F8A1DD0E883A0DC82DEC5FC303F593694344A33DF",
          "5F8A595B473660B0E9604CF9DD4FA20FE7FB0BDBE886A332EFCB5BB965008519AEDE0F92325F69BA0A600D6F0BE50FB87D7BBBF954D309FA2A4CC773E88C9086",
          "40FA27A8B4B4158E15622923BAD62E8A1BEF58FD6553E84C243E0D76B7901DE326D08CC96A5583CC9C87C567B2957535A71193AF145FFD0A3235F56947BDCBE2",
          "92F699545C9BC66C07C3DBA85C470A70C0C7A696A21F27AC896C660A096D1D2E2001DF1CCD9A8ED9472B71E3A253BB22BB4550234F89013566F715FE0DA3DFDF",
          "B08176B146EF8B8A48E641CEBE34245B43526D8DC5F77EF0D0A2EC5A2565AD741CA064AD9B54C19957E7597158D80864D16793D051E8D4A2F576AC7B3D30D3DC",
          "6834F207C3F1EA21160A312AAB3E4865ADB0DFC64F572EE82A65597AA064475B1F4233B1CE2CF39BF30DD43D1A5458F3791E9DFE67AD5AEB1EA012F243EB8677",
          "4436F061872691E62721D84F319EE7B033330D4B60BDED0055B128A17FEA0B9E454AA7B192CAB61690AE47B71366165FC16D403691ED8D7F403E9BEB5637935E",
          "0BD02FE4F230ACC82F5390C4EDEDF01E1193B5A1C5E922149329B1D593CA0187D674ABB0CF5E26059B57866CBA8BA04A2D4A91F3A56D73B36C10C1C467D2124B",
          "C1602B5D7ED19242BB33E9449500C6D0D6F881F04647426D34F9CA81CE4BC7D2D83F0A3A3B0F66F04CA778F239BE23B3930B9446F136DA8C3B30DB646E8AE6DF",
          "14A41C12C7B59F4CA45A3115D33CACC02753B1281E10ABEEAA8A756F02B1DA1CBC78F9720E7FCC89EBF7173D68288A397FDFC80ECCACB9290CA337957896C80D",
          "32FA5607F981E9FA7B83835E1DD554602D4892F1CF775A9CE39FD0850D01FDEB85AF1B7B513ACFBC747CC8F995473FE7D96D2E6F603B7467F7FDA63649EC42E8",
          "524EB8461BADE0D0FF541B82E409393EB5D16F476485B7427FA912DC3E5A53FA79B9E48E0A76AC99B161D4AD33AC5F2BFF95B7753E2DA0BA4312A69CE9F95098",
          "EFD0077B8A8528F29EC2BC9B269C8284540D25856DC978585C1BC332B33FF206DD95842FDE090AD04B620E6AB7802FD37E24EC71135B742DB2843D4C913B1C5D",
          "968660EBDEEC7437C85614AE150A9CF52146C713298E4165BE120995BEF96FC22FB1F6AF0988EE9F41D7D5BA0FD309480A46457AEE7897404F538D7E8651C41E",
          "A736F364778715600D1918A2347D0755596538C6414F6B80E5E2BC63A0D441E91852388F06A0CC8F36240D60DC1FFC679297B815A2683581279336347E39E9AD",
          "650CE8B7B5A2A3F11E83E26E5F6A5B7EFE019F6685F761D6E74E926938AAA9700C5F43F9135237A59FF26A3646B699ED7C5A36D8B6866F4687B75B35E4E1C03B",
          "318795992503BA9F653CC9F640773D6AFF7270FD25A03F6D1C2C9289F1FB841A8B67A55A5FAF4EB8324763BDA6807D54833407CA3126527F7E1B75885E391D18",
          "AA9A09BA9C17DAEDBBF81E1ED7D7450DB54E5202DC43D848997CE32C245A9DF5E3D2AE1D52B4F5867EBED028F4E78CFB939B7E467422DA351E16157269D9F75A",
          "0062F9CCF555CA62ED5B31B5F169EE56A7BC3DB37A279C58C2A8A6D415ADFFF6686915364D1BC952A50BC118811C0C39FB4DA7B336F3332D20634C4940F71523",
          "6405217616DCB82570254DD4FB48A9D7D300B86C22B195A178EBFE94BC11D8392B13100CCFF8A828A69AFEF0F6BEBB1432D36BD92B46074A0DBB1ED6F8099BFB",
          "4340979A0DDC2562674D5033512C60985982BB1AA25D10C6B86F6FB84557EA27ED3B02C3F201AB53AFD38A0B2CE7E4292F1B6834FFBADFC4776218CD93A4D553",
          "02FBA538C78D99B59309BAFD840220914B4281E9A6719FD2E8060AEE6C70D3FAC44E63D24A0A2A32F680435CD792CE7D3D55B29843FEB3437C8FB9B35FD87A79",
          "6385D28EDD060DF141233519FBA359B9FC7592A041ECDA1261356566501CA50C2C7C7B24A3BCAA7D001D7DA6BA847461E4DEB0EFCEDF15B695D46F822668A280",
          "63D3681E7F5A6A9578651756B297771F63461C7B6C1320E5363FF0C4977FCF5044FB783C83539B5CA91DE1086CD61A04BCB09D8426C995BDD64F13711A8C4053",
          "6DED903D739CC90C37A17DB1EEABEAF6A7B67F9436A68765715BF608786B22DABB719A801613F57290654B5413E3A39F375631266DE80F6987A1B163E2D8149A",
          "BEA1CAC9FC06422AB960D4127E3B4A332FBCEAFC39D4033E312CFDC57BB3D290F7E352D57129C94E79238D54EAAA045102596F45439E523CFA9B4E06ABF33FD0",
          "7017897B456131240999C880ADBA02CC800CF3C6A39FBD7A8CC6153EF39EF3E87CFA01079AF8CDC32E8D2C9656FC5E785A281DF58C4540531780846A51D02688",
          "F7B24D198320205C87090A13CEB90CC7824D2B95191D026BDD765C6F47A053AFB6B06603C8C3BE57870DFD06BB3CEE0BB84FE8249FF20D47003AC95DB411FFB5",
          "5A66FF9763B4FA6B0DAFA38D705B638E90C448E7617488073F22CF08B6124717259D592DF14A44651797452FCAB03D4EA59AE918C8D4D249033856D9A9B4DFA3",
          "6638F9386446FC9A64C501FB66EFAC627429D9674CB6B7C62A72FC1E1CC18E7FEED735DACD932ADE747423904B865368CA273C64489651343B30DAAD56627764",
          "A4EC9B21EE4CCCFB3355238F7FE726B27E6773E26ACFA7C16E5AA57603B68B7C381AC7B22FF80E4409E76EECE41AC41F21ECA9FE6CF06272FC464C0877B0DFB4",
          "21FC851806BD39BFCC35242248AD09B2DA7B2E28770309D2EBF92B60273B536F6C291EC940BA446989A5343FBDC505DEECE005EFE73306629059BFC87481BDAA",
          "DF7DE44A0ACF2A1D1BEBB2FBA2E2E73EDAA6C2B0575354E65451B12119DF9795F667B2DEDCAA1F16CDDB97FE59F79C0549E43A46BEAFC5445E3142178B7BDDFA",
          "71F11AF9FB5EFED0AE84F0349275565A822685142C2EE5C3FC7A4F067A5ECEB65A7FB399449441E121FED9E29C6B87D9A54A7E461B5627D9A30241D19C8D4792",
          "141E1EBB14A11103E5A01AC429542ABC6E14133DEC954012F4C331182C9CCF218EF133C3BC053B185E6587F50A7AAC8578C6C50F98FFD9409A70ABBB34D7D468",
          "43DAF17C931ACBD856E986D26048335D8BB40AA4B86D2D936FFE564AD72FED2C88450EBD42D83D3278044A3A554DC87AC66AB833C1E2B896AE777BB9AB6D9072",
          "EE091D53866ADD3003F06C87DB58DA537F94C211354E5D4DA8810AC0DD1871C11ADBFBDB375198B748582459C3FF6F829023FED4657C16F9774F93EC012BE1E0",
          "9C3BA1B6E11B0E910A7531FFCB5531FC2036D2EC83D8BBF8446008E38127B1C22DA7D29E325AFBA82EFDB56A3DA1579DB8CBA8F3B86418AE5ADB47C23F674D8D",
          "F9C7A0153307B7D3B85E887DFDAB07401CFBF1C4844EF41485E6608D18CF3BCDFF940AEA3E38AA687362C8D0365AC49A576512FDB9162A764B948FA52E75F70A",
          "D714233D29CD260B21EB10184B8041304E8D676EF979AC72EAE6174A6BAAC4D14B87CB8EBC52F90A236FB8E7A57C9A5A022946A0724AD38AC57696552C0F9A15",
          "78648E4C8BE6A6BFC1B14CAFFFCD14B49E53F49B7520543DFA7E75874C849558C251FB32E59E300B0791BFB2A3A64D8EE1D9C2EA76D6A6C4EBA1A65FC989BD66",
          "7E10BC2C5838765EA8AA10D413083B13D0440B458C64900A14DAC7EEB372D13E84E03805691D9D6E7B6243BB259348FD4E5E049EC75F783376BC6449E94B5DB3",
          "1CFCA529D925521FBAF3DEE113480B224F7CC7BE279EC727CC15BA5AA8144172DB347344D24EDF1F33EEEBA33CAA6930FA0B2271B1A79C46AA1E1D3DAB57BFD0",
          "333D7757FE6C0AEE7460F24B2B7FD93F9A9178F417C76FA16F7AB990D23E330F3677A66F12807ED0F82A825964A99B0C78C677C36BD9BB941BA837628360B831",
          "D65C464D4AE5CC3B87B7EA1EBB167232B5977BB6F2B803BEB588563457AFCB56D3460DD7C2F7CAE823B268E747116AB61E3FA5C28C6733A8345894A3AC9A9E97",
          "6210918811D6F1A7F548874E1A835E972651DCFA623548786A19A813684C043ADDE1C52E9E6B130899C47BD060A7919623DA66A028562E8998D08EF265D115EF",
          "90F55384BE338432F80952C81CDD0ACE5B0A0EDED1E0F18B47DAC286A31363E13F517BF9EAAA57FDB6C357BC33CEE774997051C8F51871A3BE4BD341FDE1556E",
          "7D394939FCB024E9B742D20CBD0132C0F683FD64CC83551C97467AD0C50E0B0B78FB607A1C2040E7DB6E5CA339FDAB3F2AF1FF5D0A879757227D2F48CC88D480",
          "C1971A4DB7212D77C93AE1F61CC851256A17DE74E3C978EE9A18B8F7625A093A42CE66378DFE024D50970B3936A5EC936321487E4B0E5A5436156F4B7C454664",
          "45DEA24698ED5F65DB076691F5097DA75E1C0E040200454114C1D96168FE9FE5D4D65AAAE9065B679B4C7B959631C2279B2ADC56BE67505F04D1EA82EE01CD63",
          "B897F6870D0831720EDD172C9C1D928B7D0BB094DAC05D64329A575BA7DD33802DE2CEF977332547E5CC43DE7F20313729E44108E72A09BA2971A3B15EA60E7E",
          "6C8656EDA827CAF377992413E3F5AC4CE176183EB6ED46C64CA36EF4BAB741C0B19533D627E086F9A699E96B91F1249C5950F36C153C6BF10772F510ADA82586",
          "FC0C20FE481F16E899897545509E69E27F14F9DFF1F03BB799EB48112A3895ACA36F2CB9379FC1884474460DEC8BAE0DCD6BE84C25321804E9ED055E7BD5F96F",
          "E2D0CACE9ABCFAD9F7FAFFE7E2934305DC08C13E2BCCD16CA97E5A207117DC16FF3FDFE75B41DA297E723E11A8D0ED245D957411368F46DE7D1AA427E2D512BB",
          "1B651407EFC1B5A7A2E893F40170F21799CAC0E67925F4726AAC10402ED799D5ECDE5E1465144AF96AEB63557DA560D2886AF7F8917F2958C3832394155C2EF5",
          "5438E82BE9C46F77426D7FDB9CC7BEF6F26984556520C4A57C3321BC27F01E819F32E3EB802513F3EAD46A6CF185257D84DBC0860E2F588D62614FA16FB7ACE3",
          "A9BB402023B22D53AB23DCB843164A27E390C5A9B76AD6AD2494EA436CE5609645D3251EC180496067642DE68B0A34FAC8DD03A37758CB00F1F95AC101514AF5",
          "B68A281AF38E2958946ACDF09AE915DCAB9B2BDAC5640D99C235FC928091574691CF1DF61751BD8CD4341BD80957F24ABE122C9BB7BCEC78AB7C38A7429BC154",
          "F1BE9C30B2029087CD7C3801065EA2D273B1A2A18296E095B82B4C118D8EF44BC397A2BCC7276ACF3EA754DAA707FC7654CB1559BED3C3802FF70F199F693FA2",
          "2BEA7EEE3F5C9AF56513A543587A76B21E12DEC38F6A0CA891FB5DF7D601DE166BB1DFADBB6ED65C14227C6D05FEC67213A491CF1FD044E0ABCD1DB40FEA829C",
          "B333A595358DC3BEAEC98E0FD3D8C544F34FBEABBB14FE308350202BF4B862F448B7F58F30F7FA2F8D804DCE2B2071CE7D27627B6F1A60E08C31F7429A778137",
          "2B3EF0605DC59286CEEC451638BC02F97BDDD00CE05A421E83A2F9F1720B35C85AD2A810522BBF7E138A9E7320AA9E17188056043A8D103D812153DAE7DE531A",
          "50E6297115D2AAC725861203727AE680685BCEECE8FA42A933B896196B0235AE83AAB35BB31263CC0D180B7040E9186BA93405AAB527B6A01DB3DCA2ADF4889F",
          "29FAC984D3672D94A6918E62DF6FD76438A135C3C0B912FD54CB5FC6899C95C650B4038CE5AB035151CB4EEB1E7E9EDBE92C1ACF00AB67F1E2F15FE33A240353",
          "6A9A12F1C06BA0E89790AA2525A6C618F1DA31AEFC7823D09E58FE62A75A11AC78B9CFB2D7EAD6A050BDDD60612C05EE6E24A4C69ACB7BE90822967797E1D43A",
          "41DDDE4A9E78A02B144B73203F1E99DBFB7CE914D02EDC55801EBB13477954863C897C164F0ABF6D6CF6A16D9EB0CB6AF5E3E97D8E8155E9FC79C1C7FC043000",
          "790C5FDF87EF19BFBBEED783627FF1D73D381B761FD389360E06D5E4A47484B0C30602EA57E4F8D513851B391E1A71DCC7B026615B837A4823224703172AAE86",
          "C14623695559C5311BB2AC06A3BAD23AD256291318EF9A8FC838241AF09BF064EAB7351B060F9C6E9826ECFF0BFE6AD5A1DBE7886C12C6D96E83D204486D3D3B",
          "B7F9DE3CCB19D65124DDDD1C8441D1107C5A9AC29E9990D42384FF3DFD6AECA4CF972F720C504F22DE73167F288B4036629894253D613C3CED57607D8B8DC95A",
          "355C8EF43457B8728041DB2DB9901BCBB2DC5ABC823397F2B7B9798E99F85FF0ACBAA184E0370575177AB157D5542B1CF54B5D33F7E108EEAA866735189D1A5B",
          "5BF3EECA02A91D3DB8F6ED4E08DA486AED6B4A84F455E9B567F4DCEF965B4BB06CF414C2FEB343DCBC3A675BBBB14A1F1BE26BA0D5A01CEA9CEE3B1F3D66F5C6",
          "0BD6F34224D1802820A1B9A88CB1B375E2B31526996A5DEDBCD98DE7E0EFDE66FAAD44E1B5899D0FFFE6890B6E99F55B313AB34C49BC94E0E015A5B1FAA3B54F",
          "947624A51A94672DA0161460F6B1D4ED9960714D117DDD7907ABF5E8744667B0DBAFA85A355DBCE96A70ED1EBD2CFDC3A65C6F29D04415B2668496F8FB0862B7",
          "1930AD1EA5204459E0F6F9886394ECE427CC24DDC0134BD937FC1B7CA87F97E2C99B18A6413DA1B7577A7E0D6F1B547BA47FEF13287877BCD7C54DE5B3A36B94",
          "A77F0E5F9C669F9EA1B3CADBA8989E0B3208B9797F72F740B0A8C51C6CD0501F7822ED5A2479418B0B15711E8F663BAD20F2D75C758CC86A70C522D44445732E",
          "99242A0A7E000796CB9A2984A0C016328E16420CE9BF5773169F62F58EE1E6AD9F3FC541B7EF699641BF999462F32DEC2418E0B82DA4C5215F19A3792F9E2869",
          "4455AC117793D75C8E440E585D1EC808D0C953024DDF76CB73F3D303A35D196B8C2C9F8D149D9D3B22579669FF484C973F6D505710407E126473AB0F90C1653D",
          "D162FFBCF4B8725981819D0EAEEEC86E436E659F693DD2B36CE0970233E3B1BA6D3C35C66038ACCC9925ECC4F679136DF506096C85FEDC3E8395D1C86D269E3B",
          "EE884C923D23ED104A1BB67AE7E541282D906B5893F47BE8744404C4F0DEB86308A031105A4A2B32B7B39608696AA5CF0EB492A0AAA033125A7572C97671E262",
          "021B35D4042DF386EF7136ABBC56910E7DE020C573F6C197A2A4FD1D8BE415C4020B80852ED2C42016177E9E8492233AD97252BD01B07DA737DA87C4BDC38593",
        ];
        h = std.checksum.SHA512();
        for(each k, v -> sha512_results) {
          // split
          for(var i = 0; i < k; ++i) {
            h.update(s);
          }
          assert h.finish() == v;
          // simple
          assert std.checksum.sha512(s * k) == v;
        }
        h = std.checksum.SHA512();
        h.update("hello");
        q = h;
        h.update("1");
        assert h.finish() == "1DABFEADB6451E4903649FE6EFEC8ECDA6B40E5BA99F73DFB5510956DF496ECB1EBB625B9376BBCEF223B354481633E9B977872AEF979478E6451975E714C31F";
        q.update("2");
        assert q.finish() == "8A1F14557F5E8C70DA697611E231787D236F9A992D46244BDB37954A10F469DD71D7113544F12CF70A18CC14B0B83C0E6B4801326770414920C87A8B0B4A23E6";

        assert std.checksum.sha512_file((__file>>3)+"txt") == "D89171F486A25433814A2A6156BDA24D3B48895548EBE2174F06B80E38892BDA08A19C25AAA5E2DFD58D1771A1568E94554F8BB7F3E9741116C2AA8032F848CB";
        assert catch( std.checksum.sha512_file("nonexistent") ) != null;

///////////////////////////////////////////////////////////////////////////////
      )__"));
    code.execute();
  }
